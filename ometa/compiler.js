{PhotonASTTraversal=objectThatDelegatesTo(OMeta,{
"trans":function(){var $elf=this,_fromIdx=this.input.idx,t,ans;return this._form((function(){return (function(){t=this._apply("anything");return ans=this._applyWithArgs("apply",t)}).call(this)}))},
"global":function(){var $elf=this,_fromIdx=this.input.idx,ctxt,r;return (function(){ctxt=this._apply("anything");return r=this._apply("trans")}).call(this)},
"this":function(){var $elf=this,_fromIdx=this.input.idx;return this._apply("end")},
"break":function(){var $elf=this,_fromIdx=this.input.idx;return this._apply("end")},
"continue":function(){var $elf=this,_fromIdx=this.input.idx;return this._apply("end")},
"number":function(){var $elf=this,_fromIdx=this.input.idx,n;return n=this._apply("anything")},
"string":function(){var $elf=this,_fromIdx=this.input.idx,s;return s=this._apply("anything")},
"arr":function(){var $elf=this,_fromIdx=this.input.idx,xs;return xs=this._many((function(){return this._apply("trans")}))},
"unop":function(){var $elf=this,_fromIdx=this.input.idx,op,x;return (function(){op=this._apply("anything");return x=this._apply("trans")}).call(this)},
"getp":function(){var $elf=this,_fromIdx=this.input.idx,x,fd;return (function(){x=this._apply("trans");return fd=this._apply("trans")}).call(this)},
"get":function(){var $elf=this,_fromIdx=this.input.idx,x;return x=this._apply("anything")},
"set":function(){var $elf=this,_fromIdx=this.input.idx,lhs,rhs;return (function(){lhs=this._apply("trans");return rhs=this._apply("trans")}).call(this)},
"mset":function(){var $elf=this,_fromIdx=this.input.idx,lhs,op,rhs;return (function(){lhs=this._apply("trans");op=this._apply("anything");return rhs=this._apply("trans")}).call(this)},
"binop":function(){var $elf=this,_fromIdx=this.input.idx,op,x,y;return (function(){op=this._apply("anything");x=this._apply("trans");return y=this._apply("trans")}).call(this)},
"preop":function(){var $elf=this,_fromIdx=this.input.idx,op,x;return (function(){op=this._apply("anything");return x=this._apply("trans")}).call(this)},
"postop":function(){var $elf=this,_fromIdx=this.input.idx,op,x;return (function(){op=this._apply("anything");return x=this._apply("trans")}).call(this)},
"return":function(){var $elf=this,_fromIdx=this.input.idx,x;return x=this._apply("trans")},
"with":function(){var $elf=this,_fromIdx=this.input.idx,x,s;return (function(){x=this._apply("trans");return s=this._apply("trans")}).call(this)},
"if":function(){var $elf=this,_fromIdx=this.input.idx,cond,t,e;return (function(){cond=this._apply("trans");t=this._apply("trans");return e=this._apply("trans")}).call(this)},
"condExpr":function(){var $elf=this,_fromIdx=this.input.idx,cond,t,e;return (function(){cond=this._apply("trans");t=this._apply("trans");return e=this._apply("trans")}).call(this)},
"while":function(){var $elf=this,_fromIdx=this.input.idx,cond,body;return (function(){cond=this._apply("trans");return body=this._apply("trans")}).call(this)},
"doWhile":function(){var $elf=this,_fromIdx=this.input.idx,body,cond;return (function(){body=this._apply("trans");return cond=this._apply("trans")}).call(this)},
"for":function(){var $elf=this,_fromIdx=this.input.idx,init,cond,upd,body;return (function(){init=this._apply("trans");cond=this._apply("trans");upd=this._apply("trans");return body=this._apply("trans")}).call(this)},
"forIn":function(){var $elf=this,_fromIdx=this.input.idx,x,arr,body;return (function(){x=this._apply("trans");arr=this._apply("trans");return body=this._apply("trans")}).call(this)},
"begin":function(){var $elf=this,_fromIdx=this.input.idx,x,xs;return this._or((function(){return (function(){x=this._apply("trans");return this._apply("end")}).call(this)}),(function(){return xs=this._many((function(){return this._apply("trans")}))}))},
"func":function(){var $elf=this,_fromIdx=this.input.idx,args,ctxt,body;return (function(){args=this._apply("anything");ctxt=this._apply("anything");return body=this._apply("trans")}).call(this)},
"funcStmt":function(){var $elf=this,_fromIdx=this.input.idx,name,fct;return (function(){name=this._apply("anything");return fct=this._apply("trans")}).call(this)},
"call":function(){var $elf=this,_fromIdx=this.input.idx,fn,args;return (function(){fn=this._apply("trans");return args=this._many((function(){return this._apply("trans")}))}).call(this)},
"ccall":function(){var $elf=this,_fromIdx=this.input.idx,fn,args;return (function(){fn=this._apply("trans");return args=this._many((function(){return this._apply("trans")}))}).call(this)},
"send":function(){var $elf=this,_fromIdx=this.input.idx,msg,recv,args;return (function(){msg=this._apply("anything");recv=this._apply("trans");return args=this._many((function(){return this._apply("trans")}))}).call(this)},
"new":function(){var $elf=this,_fromIdx=this.input.idx,fn,args;return (function(){fn=this._apply("trans");return args=this._many((function(){return this._apply("trans")}))}).call(this)},
"var":function(){var $elf=this,_fromIdx=this.input.idx,name,val;return (function(){name=this._apply("anything");return val=this._apply("trans")}).call(this)},
"throw":function(){var $elf=this,_fromIdx=this.input.idx,x;return x=this._apply("trans")},
"try":function(){var $elf=this,_fromIdx=this.input.idx,ctxt,x,name,c,f;return (function(){ctxt=this._apply("anything");x=this._apply("trans");name=this._apply("anything");c=this._apply("trans");return f=this._apply("trans")}).call(this)},
"json":function(){var $elf=this,_fromIdx=this.input.idx,props;return props=this._many((function(){return this._apply("trans")}))},
"binding":function(){var $elf=this,_fromIdx=this.input.idx,name,val;return (function(){name=this._apply("trans");return val=this._apply("trans")}).call(this)},
"switch":function(){var $elf=this,_fromIdx=this.input.idx,x,cases;return (function(){x=this._apply("trans");return cases=this._many((function(){return this._apply("trans")}))}).call(this)},
"case":function(){var $elf=this,_fromIdx=this.input.idx,x,y;return (function(){x=this._apply("trans");return y=this._apply("trans")}).call(this)},
"default":function(){var $elf=this,_fromIdx=this.input.idx,y;return y=this._apply("trans")},
"regexp":function(){var $elf=this,_fromIdx=this.input.idx,e;return e=this._apply("anything")},
"exprSeq":function(){var $elf=this,_fromIdx=this.input.idx,es;return es=this._many((function(){return this._apply("trans")}))},
"ref":function(){var $elf=this,_fromIdx=this.input.idx,s;return s=this._apply("anything")},
"gets":function(){var $elf=this,_fromIdx=this.input.idx,x,fd;return (function(){x=this._apply("trans");return fd=this._apply("trans")}).call(this)},
"mreturn":function(){var $elf=this,_fromIdx=this.input.idx,x,y;return (function(){x=this._apply("trans");return y=this._apply("trans")}).call(this)},
"code":function(){var $elf=this,_fromIdx=this.input.idx,c;return c=this._apply("anything")},
"super":function(){var $elf=this,_fromIdx=this.input.idx,e;return e=this._apply("trans")},
"macro":function(){var $elf=this,_fromIdx=this.input.idx,n,args,ctxt,body;return (function(){n=this._apply("anything");args=this._apply("anything");ctxt=this._apply("anything");return body=this._apply("trans")}).call(this)},
"letvar":function(){var $elf=this,_fromIdx=this.input.idx,name;return this._form((function(){return (function(){this._applyWithArgs("exactly","var");name=this._apply("anything");return this._apply("trans")}).call(this)}))},
"let":function(){var $elf=this,_fromIdx=this.input.idx,ctxt;return (function(){ctxt=this._apply("anything");this._form((function(){return (function(){this._applyWithArgs("exactly","begin");return this._many((function(){return this._apply("letvar")}))}).call(this)}));return this._apply("trans")}).call(this)},
"super_send":function(){var $elf=this,_fromIdx=this.input.idx,msg,rcv,args;return (function(){msg=this._apply("anything");rcv=this._apply("trans");return args=this._many((function(){return this._apply("trans")}))}).call(this)},
"closure":function(){var $elf=this,_fromIdx=this.input.idx;return this._apply("end")},
"arguments":function(){var $elf=this,_fromIdx=this.input.idx,i;return i=this._apply("trans")},
"arguments_length":function(){var $elf=this,_fromIdx=this.input.idx;return this._apply("end")},
"arguments_slice":function(){var $elf=this,_fromIdx=this.input.idx,i;return (function(){i=this._apply("trans");return this._apply("end")}).call(this)},
"closureRef":function(){var $elf=this,_fromIdx=this.input.idx,fn,offset;return (function(){fn=this._apply("trans");return offset=this._apply("trans")}).call(this)},
"closureRefValue":function(){var $elf=this,_fromIdx=this.input.idx,fn,offset;return (function(){fn=this._apply("trans");return offset=this._apply("trans")}).call(this)},
"getCell":function(){var $elf=this,_fromIdx=this.input.idx,id;return id=this._apply("anything")},
"postcode":function(){var $elf=this,_fromIdx=this.input.idx,x,s;return (function(){x=this._apply("trans");return s=this._apply("anything")}).call(this)},
"precode":function(){var $elf=this,_fromIdx=this.input.idx,s,x;return (function(){s=this._apply("anything");return x=this._apply("trans")}).call(this)},
"igetp":function(){var $elf=this,_fromIdx=this.input.idx,x,fd;return (function(){x=this._apply("trans");return fd=this._apply("trans")}).call(this)},
"letLambda":function(){var $elf=this,_fromIdx=this.input.idx,args,values,body;return (function(){args=this._apply("anything");this._form((function(){return values=this._many((function(){return this._apply("trans")}))}));return body=this._apply("trans")}).call(this)},
"icSend":function(){var $elf=this,_fromIdx=this.input.idx,nb,msg,recv,args;return (function(){nb=this._apply("anything");msg=this._apply("anything");recv=this._apply("trans");return args=this._many((function(){return this._apply("trans")}))}).call(this)},
"wrapExpr":function(){var $elf=this,_fromIdx=this.input.idx,pre,post,es;return (function(){pre=this._apply("anything");post=this._apply("anything");return es=this._many((function(){return this._apply("trans")}))}).call(this)}});PhotonASTCopy=objectThatDelegatesTo(OMeta,{
"trans":function(){var $elf=this,_fromIdx=this.input.idx,t,ans;return (function(){this._form((function(){return (function(){t=this._apply("anything");return ans=this._applyWithArgs("apply",t)}).call(this)}));return ans}).call(this)},
"global":function(){var $elf=this,_fromIdx=this.input.idx,ctxt,r;return (function(){ctxt=this._apply("anything");r=this._apply("trans");return ["global",ctxt,r]}).call(this)},
"this":function(){var $elf=this,_fromIdx=this.input.idx;return (function(){this._apply("end");return ["this"]}).call(this)},
"break":function(){var $elf=this,_fromIdx=this.input.idx;return (function(){this._apply("end");return ["break"]}).call(this)},
"continue":function(){var $elf=this,_fromIdx=this.input.idx;return (function(){this._apply("end");return ["continue"]}).call(this)},
"number":function(){var $elf=this,_fromIdx=this.input.idx,n;return (function(){n=this._apply("anything");return ["number",n]}).call(this)},
"string":function(){var $elf=this,_fromIdx=this.input.idx,s;return (function(){s=this._apply("anything");return ["string",s]}).call(this)},
"arr":function(){var $elf=this,_fromIdx=this.input.idx,xs;return (function(){xs=this._many((function(){return this._apply("trans")}));return ["arr"].concat(xs)}).call(this)},
"unop":function(){var $elf=this,_fromIdx=this.input.idx,op,x;return (function(){op=this._apply("anything");x=this._apply("trans");return ["unop",op,x]}).call(this)},
"getp":function(){var $elf=this,_fromIdx=this.input.idx,x,fd;return (function(){x=this._apply("trans");fd=this._apply("trans");return ["getp",x,fd]}).call(this)},
"get":function(){var $elf=this,_fromIdx=this.input.idx,x;return (function(){x=this._apply("anything");return ["get",x]}).call(this)},
"set":function(){var $elf=this,_fromIdx=this.input.idx,lhs,rhs;return (function(){lhs=this._apply("trans");rhs=this._apply("trans");return ["set",lhs,rhs]}).call(this)},
"mset":function(){var $elf=this,_fromIdx=this.input.idx,lhs,op,rhs;return (function(){lhs=this._apply("trans");op=this._apply("anything");rhs=this._apply("trans");return ["mset",lhs,op,rhs]}).call(this)},
"binop":function(){var $elf=this,_fromIdx=this.input.idx,op,x,y;return (function(){op=this._apply("anything");x=this._apply("trans");y=this._apply("trans");return ["binop",op,x,y]}).call(this)},
"preop":function(){var $elf=this,_fromIdx=this.input.idx,op,x;return (function(){op=this._apply("anything");x=this._apply("trans");return ["preop",op,x]}).call(this)},
"postop":function(){var $elf=this,_fromIdx=this.input.idx,op,x;return (function(){op=this._apply("anything");x=this._apply("trans");return ["postop",op,x]}).call(this)},
"return":function(){var $elf=this,_fromIdx=this.input.idx,x;return (function(){x=this._apply("trans");return ["return",x]}).call(this)},
"with":function(){var $elf=this,_fromIdx=this.input.idx,x,s;return (function(){x=this._apply("trans");s=this._apply("trans");return ["with",x,s]}).call(this)},
"if":function(){var $elf=this,_fromIdx=this.input.idx,cond,t,e;return (function(){cond=this._apply("trans");t=this._apply("trans");e=this._apply("trans");return ["if",cond,t,e]}).call(this)},
"condExpr":function(){var $elf=this,_fromIdx=this.input.idx,cond,t,e;return (function(){cond=this._apply("trans");t=this._apply("trans");e=this._apply("trans");return ["condExpr",cond,t,e]}).call(this)},
"while":function(){var $elf=this,_fromIdx=this.input.idx,cond,body;return (function(){cond=this._apply("trans");body=this._apply("trans");return ["while",cond,body]}).call(this)},
"doWhile":function(){var $elf=this,_fromIdx=this.input.idx,body,cond;return (function(){body=this._apply("trans");cond=this._apply("trans");return ["doWhile",body,cond]}).call(this)},
"for":function(){var $elf=this,_fromIdx=this.input.idx,init,cond,upd,body;return (function(){init=this._apply("trans");cond=this._apply("trans");upd=this._apply("trans");body=this._apply("trans");return ["for",init,cond,upd,body]}).call(this)},
"forIn":function(){var $elf=this,_fromIdx=this.input.idx,x,arr,body;return (function(){x=this._apply("trans");arr=this._apply("trans");body=this._apply("trans");return ["forIn",x,arr,body]}).call(this)},
"begin":function(){var $elf=this,_fromIdx=this.input.idx,x,xs;return this._or((function(){return (function(){x=this._apply("trans");this._apply("end");return ["begin",x]}).call(this)}),(function(){return (function(){xs=this._many((function(){return this._apply("trans")}));return ["begin"].concat(xs)}).call(this)}))},
"func":function(){var $elf=this,_fromIdx=this.input.idx,args,ctxt,body;return (function(){args=this._apply("anything");ctxt=this._apply("anything");body=this._apply("trans");return ["func",args,ctxt,body]}).call(this)},
"funcStmt":function(){var $elf=this,_fromIdx=this.input.idx,name,fct;return (function(){name=this._apply("anything");fct=this._apply("trans");return ["funcStmt",name,fct]}).call(this)},
"call":function(){var $elf=this,_fromIdx=this.input.idx,fn,args;return (function(){fn=this._apply("trans");args=this._many((function(){return this._apply("trans")}));return ["call",fn].concat(args)}).call(this)},
"ccall":function(){var $elf=this,_fromIdx=this.input.idx,fn,args;return (function(){fn=this._apply("trans");args=this._many((function(){return this._apply("trans")}));return ["ccall",fn].concat(args)}).call(this)},
"send":function(){var $elf=this,_fromIdx=this.input.idx,msg,recv,args;return (function(){msg=this._apply("anything");recv=this._apply("trans");args=this._many((function(){return this._apply("trans")}));return ["send",msg,recv].concat(args)}).call(this)},
"new":function(){var $elf=this,_fromIdx=this.input.idx,fn,args;return (function(){fn=this._apply("trans");args=this._many((function(){return this._apply("trans")}));return ["new",fn].concat(args)}).call(this)},
"var":function(){var $elf=this,_fromIdx=this.input.idx,name,val;return (function(){name=this._apply("anything");val=this._apply("trans");return ["var",name,val]}).call(this)},
"throw":function(){var $elf=this,_fromIdx=this.input.idx,x;return (function(){x=this._apply("trans");return ["throw",x]}).call(this)},
"try":function(){var $elf=this,_fromIdx=this.input.idx,ctxt,x,name,c,f;return (function(){ctxt=this._apply("anything");x=this._apply("trans");name=this._apply("anything");c=this._apply("trans");f=this._apply("trans");return ["try",ctxt,x,name,c,f]}).call(this)},
"json":function(){var $elf=this,_fromIdx=this.input.idx,props;return (function(){props=this._many((function(){return this._apply("trans")}));return ["json"].concat(props)}).call(this)},
"binding":function(){var $elf=this,_fromIdx=this.input.idx,name,val;return (function(){name=this._apply("trans");val=this._apply("trans");return ["binding",name,val]}).call(this)},
"switch":function(){var $elf=this,_fromIdx=this.input.idx,x,cases;return (function(){x=this._apply("trans");cases=this._many((function(){return this._apply("trans")}));return ["switch",x].concat(cases)}).call(this)},
"case":function(){var $elf=this,_fromIdx=this.input.idx,x,y;return (function(){x=this._apply("trans");y=this._apply("trans");return ["case",x,y]}).call(this)},
"default":function(){var $elf=this,_fromIdx=this.input.idx,y;return (function(){y=this._apply("trans");return ["default",y]}).call(this)},
"regexp":function(){var $elf=this,_fromIdx=this.input.idx,e;return (function(){e=this._apply("anything");return ["regexp",e]}).call(this)},
"exprSeq":function(){var $elf=this,_fromIdx=this.input.idx,es;return (function(){es=this._many((function(){return this._apply("trans")}));return ["exprSeq"].concat(es)}).call(this)},
"ref":function(){var $elf=this,_fromIdx=this.input.idx,s;return (function(){s=this._apply("anything");return ["ref",s]}).call(this)},
"gets":function(){var $elf=this,_fromIdx=this.input.idx,x,fd;return (function(){x=this._apply("trans");fd=this._apply("trans");return ["gets",x,fd]}).call(this)},
"mreturn":function(){var $elf=this,_fromIdx=this.input.idx,x,y;return (function(){x=this._apply("trans");y=this._apply("trans");return ["mreturn",x,y]}).call(this)},
"code":function(){var $elf=this,_fromIdx=this.input.idx,c;return (function(){c=this._apply("anything");return ["code",c]}).call(this)},
"super":function(){var $elf=this,_fromIdx=this.input.idx,e;return (function(){e=this._apply("trans");return ["super",e]}).call(this)},
"macro":function(){var $elf=this,_fromIdx=this.input.idx,n,args,ctxt,body;return (function(){n=this._apply("anything");args=this._apply("anything");ctxt=this._apply("anything");body=this._apply("trans");return ["macro",n,args,ctxt,body]}).call(this)},
"letvar":function(){var $elf=this,_fromIdx=this.input.idx,name,val;return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","var");name=this._apply("anything");return val=this._apply("trans")}).call(this)}));return ["var",name,val]}).call(this)},
"let":function(){var $elf=this,_fromIdx=this.input.idx,ctxt,vs,body;return (function(){ctxt=this._apply("anything");this._form((function(){return (function(){this._applyWithArgs("exactly","begin");return vs=this._many((function(){return this._apply("letvar")}))}).call(this)}));body=this._apply("trans");return ["let",ctxt,["begin"].concat(vs),body]}).call(this)},
"super_send":function(){var $elf=this,_fromIdx=this.input.idx,msg,rcv,args;return (function(){msg=this._apply("anything");rcv=this._apply("trans");args=this._many((function(){return this._apply("trans")}));return ["super_send",msg,rcv].concat(args)}).call(this)},
"closure":function(){var $elf=this,_fromIdx=this.input.idx;return (function(){this._apply("end");return ["closure"]}).call(this)},
"arguments":function(){var $elf=this,_fromIdx=this.input.idx,i;return (function(){i=this._apply("trans");return ["arguments",i]}).call(this)},
"arguments_length":function(){var $elf=this,_fromIdx=this.input.idx;return (function(){this._apply("end");return ["arguments_length"]}).call(this)},
"arguments_slice":function(){var $elf=this,_fromIdx=this.input.idx,i;return (function(){i=this._apply("trans");this._apply("end");return ["arguments_slice",i]}).call(this)},
"closureRef":function(){var $elf=this,_fromIdx=this.input.idx,fn,offset;return (function(){fn=this._apply("trans");offset=this._apply("trans");return ["closureRef",fn,offset]}).call(this)},
"closureRefValue":function(){var $elf=this,_fromIdx=this.input.idx,fn,offset;return (function(){fn=this._apply("trans");offset=this._apply("trans");return ["closureRefValue",fn,offset]}).call(this)},
"getCell":function(){var $elf=this,_fromIdx=this.input.idx,id;return (function(){id=this._apply("anything");return ["getCell",id]}).call(this)},
"postcode":function(){var $elf=this,_fromIdx=this.input.idx,x,s;return (function(){x=this._apply("trans");s=this._apply("anything");return ["postcode",x,s]}).call(this)},
"precode":function(){var $elf=this,_fromIdx=this.input.idx,s,x;return (function(){s=this._apply("anything");x=this._apply("trans");return ["precode",s,x]}).call(this)},
"igetp":function(){var $elf=this,_fromIdx=this.input.idx,x,fd;return (function(){x=this._apply("trans");fd=this._apply("trans");return ["igetp",x,fd]}).call(this)},
"letLambda":function(){var $elf=this,_fromIdx=this.input.idx,args,values,body;return (function(){args=this._apply("anything");this._form((function(){return values=this._many((function(){return this._apply("trans")}))}));body=this._apply("trans");return ["letLambda",args,[values],body]}).call(this)},
"icSend":function(){var $elf=this,_fromIdx=this.input.idx,nb,msg,recv,args;return (function(){nb=this._apply("anything");msg=this._apply("anything");recv=this._apply("trans");args=this._many((function(){return this._apply("trans")}));return ["icSend",nb,msg,recv].concat(args)}).call(this)},
"wrapExpr":function(){var $elf=this,_fromIdx=this.input.idx,pre,post,es;return (function(){pre=this._apply("anything");post=this._apply("anything");es=this._many((function(){return this._apply("trans")}));return ["wrapExpr",pre,post].concat(es)}).call(this)}});PhotonPrettyPrinter=objectThatDelegatesTo(OMeta,{
"trans":function(){var $elf=this,_fromIdx=this.input.idx,t,ans;return (function(){this._form((function(){return (function(){t=this._apply("anything");return ans=this._applyWithArgs("apply",t)}).call(this)}));return ans}).call(this)},
"flatten":function(){var $elf=this,_fromIdx=this.input.idx,a,x;return (function(){a=this._apply("anything");return this._or((function(){return this._form((function(){return (function(){this._applyWithArgs("exactly","begin");return this._many((function(){return this._applyWithArgs("flatten",a)}))}).call(this)}))}),(function(){return (function(){x=this._apply("stmt");return a.push((($elf.ilvl() + x) + "\n"))}).call(this)}),(function(){return (function(){x=this._apply("trans");return a.push((($elf.ilvl() + x) + ";\n"))}).call(this)}))}).call(this)},
"flat":function(){var $elf=this,_fromIdx=this.input.idx,stmts;return (function(){stmts=[];this._many((function(){return this._applyWithArgs("flatten",stmts)}));return stmts.join("")}).call(this)},
"stmt":function(){var $elf=this,_fromIdx=this.input.idx,t,ans;return (function(){this._form((function(){return (function(){t=this._apply("anything");this._applyWithArgs("isStmt",t);return ans=this._applyWithArgs("apply",t)}).call(this)}));return ans}).call(this)},
"isStmt":function(){var $elf=this,_fromIdx=this.input.idx,t;return (function(){t=this._apply("anything");return this._pred(($elf["stmts"][t] !== undefined))}).call(this)},
"block":function(){var $elf=this,_fromIdx=this.input.idx,body;return (function(){this._apply("inc");body=this._apply("blockBody");this._apply("dec");return (((($elf.ilvl() + "{\n") + body) + $elf.ilvl()) + "}")}).call(this)},
"blockBody":function(){var $elf=this,_fromIdx=this.input.idx,t,ans,x;return this._or((function(){return (function(){this._form((function(){return (function(){t=this._apply("anything");this._pred((t === "begin"));return ans=this._applyWithArgs("apply","begin")}).call(this)}));return ans}).call(this)}),(function(){return (function(){x=this._apply("stmt");return (($elf.ilvl() + x) + "\n")}).call(this)}),(function(){return (function(){x=this._apply("trans");return (($elf.ilvl() + x) + ";\n")}).call(this)}))},
"exprList":function(){var $elf=this,_fromIdx=this.input.idx,name,val,es;return this._or((function(){return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","begin");return es=this._many((function(){return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","var");name=this._apply("anything");return val=this._apply("trans")}).call(this)}));return ((name + " = ") + val)}).call(this)}))}).call(this)}));return ("var " + es.join(", "))}).call(this)}),(function(){return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","begin");return es=this._many((function(){return this._apply("trans")}))}).call(this)}));return es.join(", ")}).call(this)}))},
"inc":function(){var $elf=this,_fromIdx=this.input.idx;return $elf["i"]++},
"dec":function(){var $elf=this,_fromIdx=this.input.idx;return $elf["i"]--},
"global":function(){var $elf=this,_fromIdx=this.input.idx,ctxt,r;return (function(){ctxt=this._apply("anything");r=this._apply("trans");return r}).call(this)},
"this":function(){var $elf=this,_fromIdx=this.input.idx;return (function(){this._apply("end");return "this"}).call(this)},
"break":function(){var $elf=this,_fromIdx=this.input.idx;return (function(){this._apply("end");return "break"}).call(this)},
"continue":function(){var $elf=this,_fromIdx=this.input.idx;return (function(){this._apply("end");return "continue"}).call(this)},
"number":function(){var $elf=this,_fromIdx=this.input.idx,n;return (function(){n=this._apply("anything");return String(n)}).call(this)},
"string":function(){var $elf=this,_fromIdx=this.input.idx,s;return (function(){s=this._apply("anything");return s.toProgramString()}).call(this)},
"arr":function(){var $elf=this,_fromIdx=this.input.idx,xs;return (function(){xs=this._many((function(){return this._apply("trans")}));return (("[" + xs.join(",")) + "]")}).call(this)},
"unop":function(){var $elf=this,_fromIdx=this.input.idx,op,x;return (function(){op=this._apply("anything");x=this._apply("trans");return (((("(" + op) + " ") + x) + ")")}).call(this)},
"getp":function(){var $elf=this,_fromIdx=this.input.idx,x,fd;return (function(){x=this._apply("trans");fd=this._apply("trans");return (((x + "[") + fd) + "]")}).call(this)},
"get":function(){var $elf=this,_fromIdx=this.input.idx,x;return (function(){x=this._apply("anything");return x}).call(this)},
"set":function(){var $elf=this,_fromIdx=this.input.idx,lhs,rhs;return (function(){lhs=this._apply("trans");rhs=this._apply("trans");return ((lhs + " = ") + rhs)}).call(this)},
"mset":function(){var $elf=this,_fromIdx=this.input.idx,lhs,op,rhs;return (function(){lhs=this._apply("trans");op=this._apply("anything");rhs=this._apply("trans");return ((((lhs + " ") + op) + "=") + rhs)}).call(this)},
"binop":function(){var $elf=this,_fromIdx=this.input.idx,op,x,y;return (function(){op=this._apply("anything");x=this._apply("trans");y=this._apply("trans");return (((((("(" + x) + " ") + op) + " ") + y) + ")")}).call(this)},
"preop":function(){var $elf=this,_fromIdx=this.input.idx,op,x;return (function(){op=this._apply("anything");x=this._apply("trans");return ((("(" + op) + x) + ")")}).call(this)},
"postop":function(){var $elf=this,_fromIdx=this.input.idx,op,x;return (function(){op=this._apply("anything");x=this._apply("trans");return ((("(" + x) + op) + ")")}).call(this)},
"return":function(){var $elf=this,_fromIdx=this.input.idx,x;return (function(){x=this._apply("trans");return ("return " + x)}).call(this)},
"with":function(){var $elf=this,_fromIdx=this.input.idx,x,s;return (function(){x=this._apply("trans");s=this._apply("block");return ((("with (" + x) + ")\n") + s)}).call(this)},
"if":function(){var $elf=this,_fromIdx=this.input.idx,cond,t,e;return (function(){cond=this._apply("trans");t=this._apply("block");e=this._apply("block");return ((((("if (" + cond) + ")\n") + t) + " else\n") + e)}).call(this)},
"condExpr":function(){var $elf=this,_fromIdx=this.input.idx,cond,t,e;return (function(){cond=this._apply("trans");t=this._apply("trans");e=this._apply("trans");return ((((("(" + cond) + ") ? ") + t) + " : ") + e)}).call(this)},
"while":function(){var $elf=this,_fromIdx=this.input.idx,cond,body;return (function(){cond=this._apply("trans");body=this._apply("block");return ((("while (" + cond) + ")\n") + body)}).call(this)},
"doWhile":function(){var $elf=this,_fromIdx=this.input.idx,body,cond;return (function(){body=this._apply("block");cond=this._apply("trans");return (((("do \n" + body) + "while (") + cond) + ")")}).call(this)},
"for":function(){var $elf=this,_fromIdx=this.input.idx,init,cond,upd,body;return (function(){init=this._apply("exprList");cond=this._apply("trans");upd=this._apply("exprList");body=this._apply("block");return ((((((("for (" + init) + "; ") + cond) + "; ") + upd) + ")\n") + body)}).call(this)},
"forIn":function(){var $elf=this,_fromIdx=this.input.idx,x,arr,body;return (function(){x=this._apply("trans");arr=this._apply("trans");body=this._apply("block");return ((((("for (" + x) + " in ") + arr) + ")\n") + body)}).call(this)},
"begin":function(){var $elf=this,_fromIdx=this.input.idx,stmts;return (function(){stmts=this._apply("flat");return stmts}).call(this)},
"func":function(){var $elf=this,_fromIdx=this.input.idx,args,ctxt,body;return (function(){args=this._apply("anything");ctxt=this._apply("anything");body=this._apply("block");return (((("(function (" + args.join(",")) + ")\n") + body) + ")")}).call(this)},
"call":function(){var $elf=this,_fromIdx=this.input.idx,fn,args;return (function(){fn=this._apply("trans");args=this._many((function(){return this._apply("trans")}));return (((fn + "(") + args.join(",")) + ")")}).call(this)},
"send":function(){var $elf=this,_fromIdx=this.input.idx,msg,recv,args;return (function(){msg=this._apply("anything");recv=this._apply("trans");args=this._many((function(){return this._apply("trans")}));return (((((recv + ".") + msg) + "(") + args.join(", ")) + ")")}).call(this)},
"new":function(){var $elf=this,_fromIdx=this.input.idx,fn,args;return (function(){fn=this._apply("trans");args=this._many((function(){return this._apply("trans")}));return (((("new " + fn) + "(") + args.join(", ")) + ")")}).call(this)},
"var":function(){var $elf=this,_fromIdx=this.input.idx,name,val,v;return (function(){name=this._apply("anything");v=this._or((function(){return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","get");return this._applyWithArgs("exactly","undefined")}).call(this)}));return ""}).call(this)}),(function(){return (function(){val=this._apply("trans");return (" = " + val)}).call(this)}));return (("var " + name) + v)}).call(this)},
"throw":function(){var $elf=this,_fromIdx=this.input.idx,x;return (function(){x=this._apply("trans");return ("throw " + x)}).call(this)},
"try":function(){var $elf=this,_fromIdx=this.input.idx,ctxt,x,name,c,f;return (function(){ctxt=this._apply("anything");x=this._apply("block");name=this._apply("anything");c=this._apply("block");f=this._apply("block");return ((((("try\n" + x) + " catch (") + name) + ")\n") + c)}).call(this)},
"json":function(){var $elf=this,_fromIdx=this.input.idx,props;return (function(){this._apply("inc");props=this._many((function(){return this._apply("trans")}));this._apply("dec");return (((("{\n" + props.join(",\n")) + "\n") + $elf.ilvl()) + "}")}).call(this)},
"binding":function(){var $elf=this,_fromIdx=this.input.idx,name,val;return (function(){name=this._apply("trans");val=this._apply("trans");return ((($elf.ilvl() + name) + ":") + val)}).call(this)},
"switch":function(){var $elf=this,_fromIdx=this.input.idx,x,cases;return (function(){x=this._apply("trans");this._apply("inc");cases=this._many((function(){return this._apply("trans")}));this._apply("dec");return ((((((("switch (" + x) + ")\n") + $elf.ilvl()) + "{\n") + cases.join("\n")) + $elf.ilvl()) + "}")}).call(this)},
"case":function(){var $elf=this,_fromIdx=this.input.idx,x,y;return (function(){x=this._apply("trans");this._apply("inc");y=this._apply("block");this._apply("dec");return (((($elf.ilvl() + "case ") + x) + ":\n") + y)}).call(this)},
"default":function(){var $elf=this,_fromIdx=this.input.idx,y;return (function(){this._apply("inc");y=this._apply("block");this._apply("dec");return (($elf.ilvl() + "default:\n") + y)}).call(this)},
"ccall":function(){var $elf=this,_fromIdx=this.input.idx,fn,x,args;return (function(){fn=this._apply("anything");args=this._many((function(){return x=this._apply("anything")}));return (((("@{[#ccall, " + fn) + ", ") + args.join(", ")) + "]}@")}).call(this)},
"global_return":function(){var $elf=this,_fromIdx=this.input.idx,x;return (function(){x=this._apply("trans");return ("global_return " + x)}).call(this)},
"ref":function(){var $elf=this,_fromIdx=this.input.idx,s;return (function(){s=this._apply("anything");return (("@{[#ref, " + ((s.hasOwnProperty("pp") && ((typeof s["pp"]) === "function"))?s.pp():"[object]")) + "]}@")}).call(this)},
"gets":function(){var $elf=this,_fromIdx=this.input.idx,x,fd;return (function(){x=this._apply("trans");fd=this._apply("trans");return (((x + "[@") + fd) + "]")}).call(this)},
"mreturn":function(){var $elf=this,_fromIdx=this.input.idx,x,y;return (function(){x=this._apply("anything");y=this._apply("anything");return (((("@{[#mreturn, " + x) + ", ") + y) + "]}@")}).call(this)},
"code":function(){var $elf=this,_fromIdx=this.input.idx,c;return (function(){c=this._apply("anything");return (("@{[#code, " + c.map((function (e){return "[native code]"})).join("\n")) + "]}@")}).call(this)},
"super":function(){var $elf=this,_fromIdx=this.input.idx,e;return (function(){e=this._apply("trans");return (("super(" + e) + ")")}).call(this)},
"macro":function(){var $elf=this,_fromIdx=this.input.idx,n,args,ctxt,body;return (function(){n=this._apply("anything");args=this._apply("anything");ctxt=this._apply("anything");body=this._apply("block");return ((((("macro " + n) + "(") + args.join(",")) + ")\n") + body)}).call(this)},
"letvars":function(){var $elf=this,_fromIdx=this.input.idx,name,val,es;return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","begin");return es=this._many((function(){return this._or((function(){return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","var");name=this._apply("anything");return val=this._apply("trans")}).call(this)}));return ((name + " = ") + val)}).call(this)}),(function(){return this._apply("trans")}))}))}).call(this)}));return es.join(", ")}).call(this)},
"let":function(){var $elf=this,_fromIdx=this.input.idx,ctxt,es,body;return (function(){ctxt=this._apply("anything");es=this._apply("letvars");body=this._apply("block");return (((("(let (" + es) + ")\n") + body) + ")")}).call(this)},
"closure":function(){var $elf=this,_fromIdx=this.input.idx;return "$closure"},
"super_send":function(){var $elf=this,_fromIdx=this.input.idx,msg,recv,args;return (function(){msg=this._apply("anything");recv=this._apply("trans");args=this._many((function(){return this._apply("trans")}));return (((((("super(" + recv) + ").") + msg) + "(") + args.join(" ,")) + ")")}).call(this)},
"arguments":function(){var $elf=this,_fromIdx=this.input.idx,i;return (function(){i=this._apply("trans");this._apply("end");return (("$arguments[@" + i) + "]")}).call(this)},
"arguments_length":function(){var $elf=this,_fromIdx=this.input.idx;return (function(){this._apply("end");return "$arguments_length"}).call(this)}});(PhotonPrettyPrinter["initialize"]=(function (){(this["i"]=(0));(this["sp"]=[""]);(this["stmts"]=({"if": true,"while": true,"for": true,"forIn": true,"try": true,"switch": true,"with": true}));(this["ilvl"]=(function (){while((this["i"] >= this["sp"]["length"])){this["sp"].push((this["sp"][(this["sp"]["length"] - (1))] + "    "))};return this["sp"][this["i"]]}))}));PhotonParser=objectThatDelegatesTo(Parser,{
"fromTo":function(){var $elf=this,_fromIdx=this.input.idx,x,y;return (function(){x=this._apply("anything");y=this._apply("anything");this._applyWithArgs("seq",x);this._many((function(){return (function(){this._not((function(){return this._applyWithArgs("seq",y)}));return this._apply("char")}).call(this)}));return this._applyWithArgs("seq",y)}).call(this)},
"fromTo2":function(){var $elf=this,_fromIdx=this.input.idx,x,y,s;return (function(){x=this._apply("anything");y=this._apply("anything");this._applyWithArgs("seq",x);s=this._many((function(){return (function(){this._not((function(){return this._applyWithArgs("seq",y)}));return this._apply("char")}).call(this)}));this._applyWithArgs("seq",y);return s.join("")}).call(this)},
"space":function(){var $elf=this,_fromIdx=this.input.idx;return this._or((function(){return Parser._superApplyWithArgs(this,'space')}),(function(){return this._applyWithArgs("fromTo","//","\n")}),(function(){return this._applyWithArgs("fromTo","/*","*/")}))},
"ceval":function(){var $elf=this,_fromIdx=this.input.idx,s;return (function(){s=this._applyWithArgs("fromTo2","@{","}@");return ["eval",s]}).call(this)},
"nameFirst":function(){var $elf=this,_fromIdx=this.input.idx;return this._or((function(){return this._apply("letter")}),(function(){return (function(){switch(this._apply('anything')){case "$":return "$";case "_":return "_";default: throw fail}}).call(this)}))},
"nameRest":function(){var $elf=this,_fromIdx=this.input.idx;return this._or((function(){return this._apply("nameFirst")}),(function(){return this._apply("digit")}))},
"iName":function(){var $elf=this,_fromIdx=this.input.idx,r;return (function(){r=this._applyWithArgs("firstAndRest","nameFirst","nameRest");return r.join("")}).call(this)},
"isKeyword":function(){var $elf=this,_fromIdx=this.input.idx,x;return (function(){x=this._apply("anything");return this._pred($elf._isKeyword(x))}).call(this)},
"name":function(){var $elf=this,_fromIdx=this.input.idx,n;return (function(){n=this._apply("iName");this._not((function(){return this._applyWithArgs("isKeyword",n)}));return ["name",n]}).call(this)},
"keyword":function(){var $elf=this,_fromIdx=this.input.idx,k;return (function(){k=this._apply("iName");this._applyWithArgs("isKeyword",k);return [k,k]}).call(this)},
"hexDigit":function(){var $elf=this,_fromIdx=this.input.idx,x,v;return (function(){x=this._apply("char");v=this["hexDigits"].indexOf(x.toLowerCase());this._pred((v >= (0)));return v}).call(this)},
"hexLit":function(){var $elf=this,_fromIdx=this.input.idx,n,d;return this._or((function(){return (function(){n=this._apply("hexLit");d=this._apply("hexDigit");return ((n * (16)) + d)}).call(this)}),(function(){return this._apply("hexDigit")}))},
"intDigit":function(){var $elf=this,_fromIdx=this.input.idx,x,v;return (function(){x=this._apply("char");v=this["hexDigits"].indexOf(x.toLowerCase());this._pred((v >= (0)));return v}).call(this)},
"intLit":function(){var $elf=this,_fromIdx=this.input.idx,n,d;return this._or((function(){return (function(){n=this._apply("intLit");d=this._apply("intDigit");return ((n * (10)) + d)}).call(this)}),(function(){return this._apply("intDigit")}))},
"number":function(){var $elf=this,_fromIdx=this.input.idx,n,ws,fs,sign,ds,es;return this._or((function(){return (function(){switch(this._apply('anything')){case "0":return (function(){this._applyWithArgs("exactly","x");"0x";n=this._apply("hexLit");return ["number",n]}).call(this);default: throw fail}}).call(this)}),(function(){return (function(){ws=this._many1((function(){return this._apply("digit")}));fs=this._or((function(){return (function(){switch(this._apply('anything')){case ".":return this._many1((function(){return this._apply("digit")}));default: throw fail}}).call(this)}),(function(){return (function(){this._apply("empty");return []}).call(this)}));es=this._or((function(){return (function(){switch(this._apply('anything')){case "e":return (function(){sign=this._or((function(){return (function(){switch(this._apply('anything')){case "+":return "+";case "-":return "-";default: throw fail}}).call(this)}),(function(){return (function(){this._apply("empty");return ""}).call(this)}));ds=this._many1((function(){return this._apply("digit")}));return ["e",sign].concat(ds)}).call(this);default: throw fail}}).call(this)}),(function(){return []}));return ["number",parseFloat((((ws.join("") + ".") + fs.join("")) + es.join("")))]}).call(this)}),(function(){return (function(){n=this._apply("intLit");return ["number",n]}).call(this)}))},
"escapeChar":function(){var $elf=this,_fromIdx=this.input.idx,c1,c2,c3,c4,c;return (function(){c=(function(){switch(this._apply('anything')){case "\\":return this._or((function(){return (function(){switch(this._apply('anything')){case "x":return (function(){"\\x";c1=this._apply("char");c2=this._apply("char");return (("x" + c1) + c2)}).call(this);case "u":return (function(){"\\u";c1=this._apply("char");c2=this._apply("char");c3=this._apply("char");c4=this._apply("char");return (((("u" + c1) + c2) + c3) + c4)}).call(this);case "\n":return (function(){"\\\n";return ""}).call(this);default: throw fail}}).call(this)}),(function(){return this._apply("char")}));default: throw fail}}).call(this);return unescape(("\\" + c))}).call(this)},
"str":function(){var $elf=this,_fromIdx=this.input.idx,cs,n;return this._or((function(){return (function(){switch(this._apply('anything')){case "\"":return this._or((function(){return (function(){switch(this._apply('anything')){case "\"":return (function(){this._applyWithArgs("exactly","\"");"\"\"\"";cs=this._many((function(){return this._or((function(){return this._apply("escapeChar")}),(function(){return (function(){this._not((function(){return (function(){this._applyWithArgs("exactly","\"");this._applyWithArgs("exactly","\"");this._applyWithArgs("exactly","\"");return "\"\"\""}).call(this)}));return this._apply("char")}).call(this)}))}));this._applyWithArgs("exactly","\"");this._applyWithArgs("exactly","\"");this._applyWithArgs("exactly","\"");"\"\"\"";return ["string",cs.join("")]}).call(this);default: throw fail}}).call(this)}),(function(){return (function(){cs=this._many((function(){return this._or((function(){return this._apply("escapeChar")}),(function(){return (function(){this._not((function(){return this._applyWithArgs("exactly","\"")}));return this._apply("char")}).call(this)}))}));this._applyWithArgs("exactly","\"");return ["string",cs.join("")]}).call(this)}));case "\'":return (function(){cs=this._many((function(){return this._or((function(){return this._apply("escapeChar")}),(function(){return (function(){this._not((function(){return this._applyWithArgs("exactly","\'")}));return this._apply("char")}).call(this)}))}));this._applyWithArgs("exactly","\'");return ["string",cs.join("")]}).call(this);default: throw fail}}).call(this)}),(function(){return (function(){(function(){switch(this._apply('anything')){case "#":return "#";case "`":return "`";default: throw fail}}).call(this);n=this._apply("iName");return ["string",n]}).call(this)}))},
"special":function(){var $elf=this,_fromIdx=this.input.idx,s;return (function(){s=(function(){switch(this._apply('anything')){case "(":return "(";case ")":return ")";case "{":return "{";case "}":return "}";case "[":return this._or((function(){return (function(){switch(this._apply('anything')){case "@":return "[@";default: throw fail}}).call(this)}),(function(){return "["}));case "]":return "]";case ",":return ",";case ";":return ";";case "?":return "?";case ":":return ":";case "!":return this._or((function(){return (function(){switch(this._apply('anything')){case "=":return this._or((function(){return (function(){switch(this._apply('anything')){case "=":return "!==";default: throw fail}}).call(this)}),(function(){return "!="}));default: throw fail}}).call(this)}),(function(){return "!"}));case "=":return this._or((function(){return (function(){switch(this._apply('anything')){case "=":return this._or((function(){return (function(){switch(this._apply('anything')){case "=":return "===";default: throw fail}}).call(this)}),(function(){return "=="}));default: throw fail}}).call(this)}),(function(){return "="}));case "<":return this._or((function(){return (function(){switch(this._apply('anything')){case "<":return this._or((function(){return (function(){switch(this._apply('anything')){case "=":return "<<=";default: throw fail}}).call(this)}),(function(){return "<<"}));case "=":return "<=";default: throw fail}}).call(this)}),(function(){return "<"}));case ">":return this._or((function(){return (function(){switch(this._apply('anything')){case ">":return this._or((function(){return (function(){switch(this._apply('anything')){case ">":return this._or((function(){return (function(){switch(this._apply('anything')){case "=":return ">>>=";default: throw fail}}).call(this)}),(function(){return ">>>"}));case "=":return ">>=";default: throw fail}}).call(this)}),(function(){return ">>"}));case "=":return ">=";default: throw fail}}).call(this)}),(function(){return ">"}));case "+":return this._or((function(){return (function(){switch(this._apply('anything')){case "+":return "++";case "=":return "+=";default: throw fail}}).call(this)}),(function(){return "+"}));case "-":return this._or((function(){return (function(){switch(this._apply('anything')){case "-":return "--";case "=":return "-=";default: throw fail}}).call(this)}),(function(){return "-"}));case "*":return this._or((function(){return (function(){switch(this._apply('anything')){case "=":return "*=";default: throw fail}}).call(this)}),(function(){return "*"}));case "/":return this._or((function(){return (function(){switch(this._apply('anything')){case "=":return "/=";default: throw fail}}).call(this)}),(function(){return "/"}));case "%":return this._or((function(){return (function(){switch(this._apply('anything')){case "=":return "%=";default: throw fail}}).call(this)}),(function(){return "%"}));case "&":return this._or((function(){return (function(){switch(this._apply('anything')){case "&":return this._or((function(){return (function(){switch(this._apply('anything')){case "=":return "&&=";default: throw fail}}).call(this)}),(function(){return "&&"}));case "=":return "&=";default: throw fail}}).call(this)}),(function(){return "&"}));case "|":return this._or((function(){return (function(){switch(this._apply('anything')){case "|":return this._or((function(){return (function(){switch(this._apply('anything')){case "=":return "||=";default: throw fail}}).call(this)}),(function(){return "||"}));case "=":return "|=";default: throw fail}}).call(this)}),(function(){return "|"}));case "^":return this._or((function(){return (function(){switch(this._apply('anything')){case "=":return "^=";default: throw fail}}).call(this)}),(function(){return "^"}));case ".":return ".";case "~":return "~";default: throw fail}}).call(this);return [s,s]}).call(this)},
"tok":function(){var $elf=this,_fromIdx=this.input.idx;return (function(){this._apply("spaces");return this._or((function(){return this._apply("ceval")}),(function(){return this._apply("name")}),(function(){return this._apply("keyword")}),(function(){return this._apply("number")}),(function(){return this._apply("str")}),(function(){return this._apply("special")}))}).call(this)},
"toks":function(){var $elf=this,_fromIdx=this.input.idx,ts;return (function(){ts=this._many((function(){return this._apply("token")}));this._apply("spaces");this._apply("end");return ts}).call(this)},
"token":function(){var $elf=this,_fromIdx=this.input.idx,tt,t;return (function(){tt=this._apply("anything");t=this._apply("tok");this._pred((t[(0)] === tt));return t[(1)]}).call(this)},
"spacesNoNl":function(){var $elf=this,_fromIdx=this.input.idx;return this._many((function(){return (function(){this._not((function(){return this._applyWithArgs("exactly","\n")}));return this._apply("space")}).call(this)}))},
"expr":function(){var $elf=this,_fromIdx=this.input.idx,e,t,f,rhs;return (function(){e=this._apply("orExpr");return this._or((function(){return (function(){this._applyWithArgs("token","?");t=this._apply("expr");this._applyWithArgs("token",":");f=this._apply("expr");return ["condExpr",e,t,f]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","=");rhs=this._apply("expr");return ["set",e,rhs]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","+=");rhs=this._apply("expr");return ["mset",e,"+",rhs]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","-=");rhs=this._apply("expr");return ["mset",e,"-",rhs]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","*=");rhs=this._apply("expr");return ["mset",e,"*",rhs]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","/=");rhs=this._apply("expr");return ["mset",e,"/",rhs]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","%=");rhs=this._apply("expr");return ["mset",e,"%",rhs]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","&&=");rhs=this._apply("expr");return ["mset",e,"&&",rhs]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","||=");rhs=this._apply("expr");return ["mset",e,"||",rhs]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","|=");rhs=this._apply("expr");return ["mset",e,"|",rhs]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","&=");rhs=this._apply("expr");return ["mset",e,"&",rhs]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","^=");rhs=this._apply("expr");return ["mset",e,"^",rhs]}).call(this)}),(function(){return (function(){this._applyWithArgs("token",">>>=");rhs=this._apply("expr");return ["mset",e,">>>",rhs]}).call(this)}),(function(){return (function(){this._applyWithArgs("token",">>=");rhs=this._apply("expr");return ["mset",e,">>",rhs]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","<<=");rhs=this._apply("expr");return ["mset",e,"<<",rhs]}).call(this)}),(function(){return (function(){this._apply("empty");return e}).call(this)}))}).call(this)},
"orExpr":function(){var $elf=this,_fromIdx=this.input.idx,x,y;return this._or((function(){return (function(){x=this._apply("orExpr");this._applyWithArgs("token","||");y=this._apply("andExpr");return ["binop","||",x,y]}).call(this)}),(function(){return this._apply("andExpr")}))},
"andExpr":function(){var $elf=this,_fromIdx=this.input.idx,x,y;return this._or((function(){return (function(){x=this._apply("andExpr");this._applyWithArgs("token","&&");y=this._apply("bitExpr");return ["binop","&&",x,y]}).call(this)}),(function(){return this._apply("bitExpr")}))},
"bitExpr":function(){var $elf=this,_fromIdx=this.input.idx,x,y;return this._or((function(){return (function(){x=this._apply("bitExpr");this._applyWithArgs("token","|");y=this._apply("eqExpr");return ["binop","|",x,y]}).call(this)}),(function(){return (function(){x=this._apply("bitExpr");this._applyWithArgs("token","^");y=this._apply("eqExpr");return ["binop","^",x,y]}).call(this)}),(function(){return (function(){x=this._apply("bitExpr");this._applyWithArgs("token","&");y=this._apply("eqExpr");return ["binop","&",x,y]}).call(this)}),(function(){return this._apply("eqExpr")}))},
"eqExpr":function(){var $elf=this,_fromIdx=this.input.idx,x,y;return this._or((function(){return (function(){x=this._apply("eqExpr");return this._or((function(){return (function(){this._applyWithArgs("token","==");y=this._apply("relExpr");return ["binop","==",x,y]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","!=");y=this._apply("relExpr");return ["binop","!=",x,y]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","===");y=this._apply("relExpr");return ["binop","===",x,y]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","!==");y=this._apply("relExpr");return ["binop","!==",x,y]}).call(this)}))}).call(this)}),(function(){return this._apply("relExpr")}))},
"relExpr":function(){var $elf=this,_fromIdx=this.input.idx,x,y;return this._or((function(){return (function(){x=this._apply("relExpr");return this._or((function(){return (function(){this._applyWithArgs("token",">");y=this._apply("sftExpr");return ["binop",">",x,y]}).call(this)}),(function(){return (function(){this._applyWithArgs("token",">=");y=this._apply("sftExpr");return ["binop",">=",x,y]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","<");y=this._apply("sftExpr");return ["binop","<",x,y]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","<=");y=this._apply("sftExpr");return ["binop","<=",x,y]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","in");y=this._apply("sftExpr");return ["binop","in",x,y]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","instanceof");y=this._apply("sftExpr");return ["binop","instanceof",x,y]}).call(this)}))}).call(this)}),(function(){return this._apply("sftExpr")}))},
"sftExpr":function(){var $elf=this,_fromIdx=this.input.idx,x,y;return this._or((function(){return (function(){x=this._apply("sftExpr");this._applyWithArgs("token",">>>");y=this._apply("addExpr");return ["binop",">>>",x,y]}).call(this)}),(function(){return (function(){x=this._apply("sftExpr");this._applyWithArgs("token",">>");y=this._apply("addExpr");return ["binop",">>",x,y]}).call(this)}),(function(){return (function(){x=this._apply("sftExpr");this._applyWithArgs("token","<<");y=this._apply("addExpr");return ["binop","<<",x,y]}).call(this)}),(function(){return this._apply("addExpr")}))},
"addExpr":function(){var $elf=this,_fromIdx=this.input.idx,x,y;return this._or((function(){return (function(){x=this._apply("addExpr");this._applyWithArgs("token","+");y=this._apply("mulExpr");return ["binop","+",x,y]}).call(this)}),(function(){return (function(){x=this._apply("addExpr");this._applyWithArgs("token","-");y=this._apply("mulExpr");return ["binop","-",x,y]}).call(this)}),(function(){return this._apply("mulExpr")}))},
"mulExpr":function(){var $elf=this,_fromIdx=this.input.idx,x,y;return this._or((function(){return (function(){x=this._apply("mulExpr");this._applyWithArgs("token","*");y=this._apply("unary");return ["binop","*",x,y]}).call(this)}),(function(){return (function(){x=this._apply("mulExpr");this._applyWithArgs("token","/");y=this._apply("unary");return ["binop","/",x,y]}).call(this)}),(function(){return (function(){x=this._apply("mulExpr");this._applyWithArgs("token","%");y=this._apply("unary");return ["binop","%",x,y]}).call(this)}),(function(){return this._apply("unary")}))},
"unary":function(){var $elf=this,_fromIdx=this.input.idx,p;return this._or((function(){return (function(){this._applyWithArgs("token","-");p=this._apply("postfix");return ["unop","-",p]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","+");p=this._apply("postfix");return ["unop","+",p]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","++");p=this._apply("postfix");return ["preop","++",p]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","--");p=this._apply("postfix");return ["preop","--",p]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","!");p=this._apply("unary");return ["unop","!",p]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","void");p=this._apply("unary");return ["unop","void",p]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","delete");p=this._apply("unary");return ["unop","delete",p]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","typeof");p=this._apply("unary");return ["unop","typeof",p]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","~");p=this._apply("unary");return ["unop","~",p]}).call(this)}),(function(){return this._apply("postfix")}))},
"postfix":function(){var $elf=this,_fromIdx=this.input.idx,p,op;return (function(){p=this._apply("primExpr");return this._or((function(){return (function(){this._apply("spacesNoNl");op=this._or((function(){return (function(){this._applyWithArgs("token","++");return "++"}).call(this)}),(function(){return (function(){this._applyWithArgs("token","--");return "--"}).call(this)}));return ["postop",op,p]}).call(this)}),(function(){return (function(){this._apply("empty");return p}).call(this)}))}).call(this)},
"primExpr":function(){var $elf=this,_fromIdx=this.input.idx,p,i,n,k,f,as;return this._or((function(){return (function(){p=this._apply("primExpr");return this._or((function(){return (function(){this._applyWithArgs("token","[@");i=this._apply("expr");this._applyWithArgs("token","]");return ["gets",p,i]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","[");i=this._apply("expr");this._applyWithArgs("token","]");return ["getp",p,i]}).call(this)}),(function(){return (function(){this._applyWithArgs("token",".");f=this._or((function(){return n=this._applyWithArgs("token","name")}),(function(){return (function(){k=this._apply("keyword");return k[(0)]}).call(this)}));return ["getp",p,["string",f]]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","(");as=this._applyWithArgs("listOf","expr",",");this._applyWithArgs("token",")");return ["call",p].concat(as)}).call(this)}))}).call(this)}),(function(){return this._apply("newExpr")}),(function(){return this._apply("primExprHd")}))},
"newExpr":function(){var $elf=this,_fromIdx=this.input.idx,e,as;return (function(){this._applyWithArgs("token","new");this._or((function(){return (function(){e=this._apply("innerNewExpr");this._applyWithArgs("token","(");as=this._applyWithArgs("listOf","expr",",");return this._applyWithArgs("token",")")}).call(this)}),(function(){return (function(){e=this._apply("innerNewExpr");return as=[]}).call(this)}));return ["new",e].concat(as)}).call(this)},
"innerNewExpr":function(){var $elf=this,_fromIdx=this.input.idx,p,i,n,k,f;return this._or((function(){return (function(){p=this._apply("innerNewExpr");return this._or((function(){return (function(){this._applyWithArgs("token","[@");i=this._apply("expr");this._applyWithArgs("token","]");return ["gets",p,i]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","[");i=this._apply("expr");this._applyWithArgs("token","]");return ["getp",p,i]}).call(this)}),(function(){return (function(){this._applyWithArgs("token",".");f=this._or((function(){return n=this._applyWithArgs("token","name")}),(function(){return (function(){k=this._apply("keyword");return k[(0)]}).call(this)}));return ["getp",p,["string",f]]}).call(this)}))}).call(this)}),(function(){return this._apply("newExpr")}),(function(){return this._apply("primExprHd")}))},
"regexpEsc":function(){var $elf=this,_fromIdx=this.input.idx;return (function(){switch(this._apply('anything')){case "\\":return (function(){switch(this._apply('anything')){case "\\":return (function(){"\\\\";return "\\\\"}).call(this);case "/":return (function(){"\\/";return "\\/"}).call(this);default: throw fail}}).call(this);default: throw fail}}).call(this)},
"primExprHd":function(){var $elf=this,_fromIdx=this.input.idx,e,es,i,n,s,re,c1,c2,bs;return this._or((function(){return (function(){this._applyWithArgs("token","super");this._applyWithArgs("token","(");e=this._apply("expr");this._applyWithArgs("token",")");return ["super",e]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","(");es=this._applyWithArgs("listOf","expr",",");this._applyWithArgs("token",")");return ((es["length"] === (1))?es[(0)]:["exprSeq"].concat(es))}).call(this)}),(function(){return (function(){this._applyWithArgs("token","this");return ["this"]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","$closure");return ["closure"]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","$arguments");this._applyWithArgs("token","[");i=this._apply("expr");this._applyWithArgs("token","]");return ["arguments",i]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","$arguments_length");return ["arguments_length"]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","$arguments_slice");this._applyWithArgs("token","(");i=this._apply("expr");this._applyWithArgs("token",")");return ["arguments_slice",i]}).call(this)}),(function(){return (function(){n=this._applyWithArgs("token","name");return ["get",n]}).call(this)}),(function(){return (function(){n=this._applyWithArgs("token","number");return ["number",n]}).call(this)}),(function(){return (function(){s=this._applyWithArgs("token","string");return ["string",s]}).call(this)}),(function(){return (function(){this._apply("spaces");this._applyWithArgs("exactly","/");re=this._many1((function(){return this._or((function(){return this._apply("regexpEsc")}),(function(){return (function(){this._not((function(){return this._applyWithArgs("exactly","/")}));return this._apply("char")}).call(this)}))}));this._applyWithArgs("exactly","/");c1=this._or((function(){return (function(){switch(this._apply('anything')){case "g":return "g";case "i":return "i";case "m":return "m";case "y":return "y";default: throw fail}}).call(this)}),(function(){return (function(){this._apply("empty");return ""}).call(this)}));c2=this._or((function(){return (function(){switch(this._apply('anything')){case "g":return "g";case "i":return "i";case "m":return "m";case "y":return "y";default: throw fail}}).call(this)}),(function(){return (function(){this._apply("empty");return ""}).call(this)}));return ["regexp",(((("/" + re.join("")) + "/") + c1) + c2)]}).call(this)}),(function(){return (function(){s=this._applyWithArgs("token","eval");return eval(s)}).call(this)}),(function(){return (function(){this._applyWithArgs("token","function");return this._apply("funcRest")}).call(this)}),(function(){return (function(){this._applyWithArgs("token","let");this._applyWithArgs("token","(");bs=this._applyWithArgs("listOf","binding",",");this._applyWithArgs("token",")");s=this._apply("stmt");return ["let",_new_context(),["begin"].concat(bs),s]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","[");es=this._applyWithArgs("listOf","expr",",");this._applyWithArgs("token","]");return ["arr"].concat(es)}).call(this)}),(function(){return this._apply("json")}))},
"json":function(){var $elf=this,_fromIdx=this.input.idx,bs;return (function(){this._applyWithArgs("token","{");bs=this._applyWithArgs("listOf","jsonBinding",",");this._applyWithArgs("token","}");return ["json"].concat(bs)}).call(this)},
"jsonBinding":function(){var $elf=this,_fromIdx=this.input.idx,n,v;return (function(){n=this._apply("jsonPropName");this._applyWithArgs("token",":");v=this._apply("expr");return ["binding",n,v]}).call(this)},
"jsonPropName":function(){var $elf=this,_fromIdx=this.input.idx,n,s;return this._or((function(){return (function(){n=this._applyWithArgs("token","name");return ["string",n]}).call(this)}),(function(){return (function(){n=this._applyWithArgs("token","number");return ["number",n]}).call(this)}),(function(){return (function(){s=this._applyWithArgs("token","string");return ["string",s]}).call(this)}))},
"formal":function(){var $elf=this,_fromIdx=this.input.idx;return (function(){this._apply("spaces");return this._applyWithArgs("token","name")}).call(this)},
"funcRest":function(){var $elf=this,_fromIdx=this.input.idx,fs,body;return (function(){this._applyWithArgs("token","(");fs=this._applyWithArgs("listOf","formal",",");this._applyWithArgs("token",")");this._applyWithArgs("token","{");body=this._apply("srcElems");this._applyWithArgs("token","}");return ["func",fs,_new_context(),body]}).call(this)},
"sc":function(){var $elf=this,_fromIdx=this.input.idx;return this._or((function(){return (function(){this._apply("spacesNoNl");return this._or((function(){return (function(){switch(this._apply('anything')){case "\n":return "\n";default: throw fail}}).call(this)}),(function(){return this._lookahead((function(){return this._applyWithArgs("exactly","}")}))}),(function(){return this._apply("end")}))}).call(this)}),(function(){return this._applyWithArgs("token",";")}))},
"binding":function(){var $elf=this,_fromIdx=this.input.idx,n,v;return (function(){n=this._applyWithArgs("token","name");v=this._or((function(){return (function(){this._applyWithArgs("token","=");return this._apply("expr")}).call(this)}),(function(){return (function(){this._apply("empty");return ["get","undefined"]}).call(this)}));return ["var",n,v]}).call(this)},
"block":function(){var $elf=this,_fromIdx=this.input.idx,ss;return (function(){this._applyWithArgs("token","{");ss=this._apply("srcElems");this._applyWithArgs("token","}");return ss}).call(this)},
"stmt":function(){var $elf=this,_fromIdx=this.input.idx,bs,c,t,f,s,es,i,u,v,e,fe,cs,x;return this._or((function(){return this._apply("block")}),(function(){return (function(){this._or((function(){return this._applyWithArgs("token","var")}),(function(){return this._applyWithArgs("token","const")}));bs=this._applyWithArgs("listOf","binding",",");this._apply("sc");return ["begin"].concat(bs)}).call(this)}),(function(){return (function(){this._applyWithArgs("token","if");this._applyWithArgs("token","(");c=this._apply("expr");this._applyWithArgs("token",")");t=this._apply("stmt");f=this._or((function(){return (function(){this._applyWithArgs("token","else");return this._apply("stmt")}).call(this)}),(function(){return (function(){this._apply("empty");return ["get","undefined"]}).call(this)}));return ["if",c,t,f]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","while");this._applyWithArgs("token","(");c=this._apply("expr");this._applyWithArgs("token",")");s=this._apply("stmt");return ["while",c,s]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","do");s=this._apply("stmt");this._applyWithArgs("token","while");this._applyWithArgs("token","(");c=this._apply("expr");this._applyWithArgs("token",")");this._apply("sc");return ["doWhile",s,c]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","for");this._applyWithArgs("token","(");i=this._or((function(){return (function(){this._applyWithArgs("token","var");bs=this._applyWithArgs("listOf","binding",",");return ["begin"].concat(bs)}).call(this)}),(function(){return (function(){es=this._applyWithArgs("listOf","expr",",");return ["begin"].concat(es)}).call(this)}),(function(){return (function(){this._apply("empty");return ["get","undefined"]}).call(this)}));this._applyWithArgs("token",";");c=this._or((function(){return this._apply("expr")}),(function(){return (function(){this._apply("empty");return ["get","true"]}).call(this)}));this._applyWithArgs("token",";");u=this._or((function(){return (function(){es=this._applyWithArgs("listOf","expr",",");return ["begin"].concat(es)}).call(this)}),(function(){return (function(){this._apply("empty");return ["get","undefined"]}).call(this)}));this._applyWithArgs("token",")");s=this._apply("stmt");return ["for",i,c,u,s]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","for");this._applyWithArgs("token","(");this._or((function(){return (function(){this._applyWithArgs("token","var");v=this._apply("binding");this._applyWithArgs("token","in");return e=this._apply("expr")}).call(this)}),(function(){return (function(){fe=this._apply("expr");this._pred(((fe[(0)] === "binop") && (fe[(1)] === "in")));v=fe[(2)];return e=fe[(3)]}).call(this)}));this._applyWithArgs("token",")");s=this._apply("stmt");return ["forIn",v,e,s]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","switch");this._applyWithArgs("token","(");e=this._apply("expr");this._applyWithArgs("token",")");this._applyWithArgs("token","{");cs=this._many((function(){return this._or((function(){return (function(){this._applyWithArgs("token","case");c=this._apply("expr");this._applyWithArgs("token",":");cs=this._apply("srcElems");return ["case",c,cs]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","default");this._applyWithArgs("token",":");cs=this._apply("srcElems");return ["default",cs]}).call(this)}))}));this._applyWithArgs("token","}");return ["switch",e].concat(cs)}).call(this)}),(function(){return (function(){this._applyWithArgs("token","break");this._apply("sc");return ["break"]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","continue");this._apply("sc");return ["continue"]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","throw");this._apply("spacesNoNl");e=this._apply("expr");this._apply("sc");return ["throw",e]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","try");t=this._apply("block");this._or((function(){return (function(){this._applyWithArgs("token","catch");this._applyWithArgs("token","(");e=this._or((function(){return this._applyWithArgs("token","name")}),(function(){return (function(){this._apply("empty");return undefined}).call(this)}));this._applyWithArgs("token",")");c=this._apply("block");return f=this._or((function(){return (function(){this._applyWithArgs("token","finally");return this._apply("block")}).call(this)}),(function(){return (function(){this._apply("empty");return ["get","undefined"]}).call(this)}))}).call(this)}),(function(){return (function(){this._applyWithArgs("token","finally");f=this._apply("block");c=(function(){this._apply("empty");return ["begin"]}).call(this);return e=(function(){this._apply("empty");return undefined}).call(this)}).call(this)}));return ["try",_new_context(),t,e,c,f]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","return");e=this._or((function(){return this._apply("expr")}),(function(){return (function(){this._apply("empty");return ["get","undefined"]}).call(this)}));this._apply("sc");return ["return",e]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","global_return");e=this._or((function(){return this._apply("expr")}),(function(){return (function(){this._apply("empty");return ["get","undefined"]}).call(this)}));this._apply("sc");return ["global_return",e]}).call(this)}),(function(){return (function(){this._applyWithArgs("token","with");this._applyWithArgs("token","(");x=this._apply("expr");this._applyWithArgs("token",")");s=this._apply("stmt");return ["with",x,s]}).call(this)}),(function(){return (function(){e=this._apply("expr");this._apply("sc");return e}).call(this)}),(function(){return (function(){this._applyWithArgs("token",";");return ["get","undefined"]}).call(this)}))},
"srcElem":function(){var $elf=this,_fromIdx=this.input.idx,n,f;return this._or((function(){return (function(){this._applyWithArgs("token","function");n=this._applyWithArgs("token","name");f=this._apply("funcRest");return (function (){(f[(2)]["name"]=n);return ["funcStmt",n,f]}).call(this)}).call(this)}),(function(){return (function(){this._applyWithArgs("token","macro");n=this._applyWithArgs("token","name");f=this._apply("funcRest");return ["macro",n].concat(f.slice((1)))}).call(this)}),(function(){return this._apply("stmt")}))},
"srcElems":function(){var $elf=this,_fromIdx=this.input.idx,ss;return (function(){ss=this._many((function(){return this._apply("srcElem")}));return ["begin"].concat(ss)}).call(this)},
"topLevel":function(){var $elf=this,_fromIdx=this.input.idx,r;return (function(){r=this._apply("srcElems");this._apply("spaces");this._apply("end");return ["global",_new_context(),r]}).call(this)}});(PhotonParser["initialize"]=(function (){(this["hexDigits"]="0123456789abcdef");(this["keywords"]=({}));var keywords=["break","case","catch","continue","default","delete","do","else","finally","for","function","if","in","instanceof","new","return","switch","this","throw","try","typeof","var","void","while","with","ometa","const","global_return","macro","super","let","$closure","$arguments","$arguments_length","$arguments_slice"];for(var idx=(0);(idx < keywords["length"]);idx++){(this["keywords"][keywords[idx]]=true)};(this["_isKeyword"]=(function (k){return this["keywords"].hasOwnProperty(k)}))}));var _new_context=(function (){return ({})});PhotonMacroExp=objectThatDelegatesTo(PhotonASTCopy,{
"macro":function(){var $elf=this,_fromIdx=this.input.idx,n,args,ctxt,body;return (function(){n=this._apply("anything");args=this._apply("anything");ctxt=this._apply("anything");body=this._apply("anything");return (function (){($elf["macros"][n]=["macro",n,args,ctxt,body]);return ["begin"]}).call(this)}).call(this)},
"call":function(){var $elf=this,_fromIdx=this.input.idx,x,args;return this._or((function(){return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","get");return x=this._apply("anything")}).call(this)}));this._pred(($elf["macros"][x] !== undefined));args=this._many((function(){return this._apply("trans")}));return PhotonMacroRep.createInstance(args,$elf["macros"]).match($elf["macros"][x],"trans")}).call(this)}),(function(){return PhotonASTCopy._superApplyWithArgs(this,'call')}))}});(PhotonMacroExp["initialize"]=(function (){(this["macros"]=({}))}));PhotonMacroRep=objectThatDelegatesTo(PhotonASTCopy,{
"get":function(){var $elf=this,_fromIdx=this.input.idx,x;return this._or((function(){return (function(){x=this._apply("anything");this._pred(($elf["bindings"][x] !== undefined));return $elf["bindings"][x]}).call(this)}),(function(){return PhotonASTCopy._superApplyWithArgs(this,'get')}))},
"macro":function(){var $elf=this,_fromIdx=this.input.idx,n,args,ctxt,body;return (function(){n=this._apply("anything");args=this._apply("anything");$elf.bind(args);ctxt=this._apply("anything");body=this._apply("trans");return body}).call(this)},
"begin":function(){var $elf=this,_fromIdx=this.input.idx,x,xs;return this._or((function(){return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","return");return x=this._apply("trans")}).call(this)}));this._apply("end");return x}).call(this)}),(function(){return (function(){x=this._apply("trans");this._apply("end");return ["begin",x]}).call(this)}),(function(){return (function(){xs=this._many((function(){return this._apply("trans")}));return ["begin"].concat(xs)}).call(this)}))},
"call":function(){var $elf=this,_fromIdx=this.input.idx,x,args;return this._or((function(){return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","get");return x=this._apply("anything")}).call(this)}));this._pred(($elf["macros"][x] !== undefined));args=this._many((function(){return this._apply("trans")}));return $elf.createInstance(args,$elf["macros"]).match($elf["macros"][x],"trans")}).call(this)}),(function(){return PhotonASTCopy._superApplyWithArgs(this,'call')}))}});(PhotonMacroRep["initialize"]=(function (args,macros){(this["macro_actual_args"]=args);(this["macros"]=macros);(this["bindings"]=({}));(this["bind"]=(function (args){for(var i=(0);(i < args["length"]);++i){(this["bindings"][args[i]]=this["macro_actual_args"][i])}}))}));PhotonDesugar=objectThatDelegatesTo(PhotonASTCopy,{
"global":function(){var $elf=this,_fromIdx=this.input.idx,ctxt,r,vs;return (function(){ctxt=this._apply("anything");$elf["context"].enter_function_scope();r=this._apply("trans");vs=$elf["context"].leave_function_scope("global");return (function (){var ast=undefined;if(photon["genTryCatch"]){var e=gensym();var try_ctxt=_new_context();(ast=["global",ctxt,["try",_new_context(),["begin"].concat(vs).concat(r.slice((1))),e,["begin",["code",(("print(" + e) + ".get(\"stack\"))")],["call",["get","print"],["string","Unhandled exception:"]],["call",["get","print"],["get",e]],["throw",["get",e]]],["get","undefined"]]])}else{(ast=["global",ctxt,["begin"].concat(vs).concat(r.slice((1)))])};return ast}).call(this)}).call(this)},
"func":function(){var $elf=this,_fromIdx=this.input.idx,args,ctxt,body,vs;return (function(){args=this._apply("anything");ctxt=this._apply("anything");(function (){$elf["context"].enter_function_scope();(args=$elf["context"].replace_arguments(args));return $elf["context"].args(args)}).call(this);body=this._apply("trans");vs=$elf["context"].leave_function_scope();return ["func",args,ctxt,["begin"].concat(vs).concat(body.slice((1)))]}).call(this)},
"funcStmt":function(){var $elf=this,_fromIdx=this.input.idx,name,fct;return (function(){name=this._apply("anything");$elf["context"].declare(name);fct=this._apply("trans");return (function (){$elf["context"]["fct_env"].push([name,fct]);return ["begin"]}).call(this)}).call(this)},
"var":function(){var $elf=this,_fromIdx=this.input.idx,name,val;return (function(){name=this._apply("anything");$elf["context"].declare(name);return this._or((function(){return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","get");return this._applyWithArgs("exactly","undefined")}).call(this)}));return ["begin"]}).call(this)}),(function(){return (function(){val=this._apply("trans");return ["set",["get",name],val]}).call(this)}))}).call(this)},
"unop":function(){var $elf=this,_fromIdx=this.input.idx,x,f,n;return this._or((function(){return (function(){switch(this._apply('anything')){case "typeof":return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","get");return this._applyWithArgs("exactly","window")}).call(this)}));return ["string","undefined"]}).call(this);case "delete":return this._or((function(){return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","getp");x=this._apply("trans");return f=this._apply("trans")}).call(this)}));return ["send","__delete__",x,f]}).call(this)}),(function(){return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","get");return n=this._apply("anything")}).call(this)}));return ["get","false"]}).call(this)}));default: throw fail}}).call(this)}),(function(){return PhotonASTCopy._superApplyWithArgs(this,'unop')}))},
"getp":function(){var $elf=this,_fromIdx=this.input.idx,x,fd;return (function(){x=this._apply("trans");fd=this._apply("trans");return ["send","__get__",x,fd]}).call(this)},
"mset":function(){var $elf=this,_fromIdx=this.input.idx,rcv,fd,lhs,op,rhs;return this._or((function(){return (function(){lhs=this._form((function(){return (function(){this._applyWithArgs("exactly","getp");rcv=this._apply("trans");return fd=this._apply("trans")}).call(this)}));op=this._apply("anything");rhs=this._apply("trans");return (function (){var id_rcv=gensym();var id_fd=gensym();return ["let",_new_context(),["begin",["var",id_rcv,rcv],["var",id_fd,fd]],["begin",["send","__set__",["get",id_rcv],["get",id_fd],["binop",op,["send","__get__",["get",id_rcv],["get",id_fd]],rhs]]]]}).call(this)}).call(this)}),(function(){return (function(){lhs=this._apply("trans");op=this._apply("anything");rhs=this._apply("trans");return ["set",lhs,["binop",op,lhs,rhs]]}).call(this)}))},
"preop":function(){var $elf=this,_fromIdx=this.input.idx,op,rcv,fd,x;return this._or((function(){return (function(){op=(function(){switch(this._apply('anything')){case "++":return "+";case "--":return "-";default: throw fail}}).call(this);x=this._form((function(){return (function(){this._applyWithArgs("exactly","getp");rcv=this._apply("trans");return fd=this._apply("trans")}).call(this)}));return (function (){var id_rcv=gensym();var id_fd=gensym();return ["let",_new_context(),["begin",["var",id_rcv,rcv],["var",id_fd,fd]],["begin",["send","__set__",["get",id_rcv],["get",id_fd],["binop",op,["send","__get__",["get",id_rcv],["get",id_fd]],["number",(1)]]]]]}).call(this)}).call(this)}),(function(){return (function(){op=this._apply("anything");x=this._apply("trans");return ["preop",op,x]}).call(this)}))},
"postop":function(){var $elf=this,_fromIdx=this.input.idx,op,rcv,fd,x;return this._or((function(){return (function(){op=(function(){switch(this._apply('anything')){case "++":return "+";case "--":return "-";default: throw fail}}).call(this);x=this._form((function(){return (function(){this._applyWithArgs("exactly","getp");rcv=this._apply("trans");return fd=this._apply("trans")}).call(this)}));return (function (){var id_rcv=gensym();var id_fd=gensym();var id_r=gensym();return ["let",_new_context(),["begin",["var",id_rcv,rcv],["var",id_fd,fd]],["begin",["let",_new_context(),["begin",["var",id_r,["send","__get__",["get",id_rcv],["get",id_fd]]]],["begin",["send","__set__",["get",id_rcv],["get",id_fd],["binop",op,["get",id_r],["number",(1)]]],["get",id_r]]]]]}).call(this)}).call(this)}),(function(){return (function(){op=this._apply("anything");x=this._apply("trans");return ["postop",op,x]}).call(this)}))},
"forIn":function(){var $elf=this,_fromIdx=this.input.idx,name,arr,body;return (function(){this._or((function(){return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","var");name=this._apply("anything");return this._form((function(){return (function(){this._applyWithArgs("exactly","get");return this._applyWithArgs("exactly","undefined")}).call(this)}))}).call(this)}));return $elf["context"].declare(name)}).call(this)}),(function(){return this._form((function(){return (function(){this._applyWithArgs("exactly","get");return name=this._apply("anything")}).call(this)}))}));arr=this._apply("trans");body=this._apply("trans");return ["forIn",["get",name],arr,body]}).call(this)},
"new":function(){var $elf=this,_fromIdx=this.input.idx,fn,args;return (function(){fn=this._apply("trans");args=this._many((function(){return this._apply("trans")}));return ["send","__ctor__",fn].concat(args)}).call(this)},
"call":function(){var $elf=this,_fromIdx=this.input.idx,rcv,msg,args;return this._or((function(){return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","getp");this._form((function(){return (function(){this._applyWithArgs("exactly","super");return rcv=this._apply("trans")}).call(this)}));return this._or((function(){return this._form((function(){return (function(){this._applyWithArgs("exactly","string");return msg=this._apply("anything")}).call(this)}))}),(function(){return error("Super send need a static message name")}))}).call(this)}));args=this._many((function(){return this._apply("trans")}));return ["super_send",msg,rcv].concat(args)}).call(this)}),(function(){return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","getp");rcv=this._apply("trans");return this._form((function(){return (function(){this._applyWithArgs("exactly","string");return msg=this._apply("anything")}).call(this)}))}).call(this)}));args=this._many((function(){return this._apply("trans")}));return ["send",msg,rcv].concat(args)}).call(this)}),(function(){return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","getp");rcv=this._apply("trans");return msg=this._apply("trans")}).call(this)}));args=this._many((function(){return this._apply("trans")}));return (function (){var id_rcv=gensym();return ["let",_new_context(),["begin",["var",id_rcv,rcv]],["begin",["send","call",["send","__get__",["get",id_rcv],msg],["get",id_rcv]].concat(args)]]}).call(this)}).call(this)}),(function(){return PhotonASTCopy._superApplyWithArgs(this,'call')}))},
"set":function(){var $elf=this,_fromIdx=this.input.idx,rcv,fd,rhs;return this._or((function(){return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","getp");rcv=this._apply("trans");return fd=this._apply("trans")}).call(this)}));rhs=this._apply("trans");return ["send","__set__",rcv,fd,rhs]}).call(this)}),(function(){return PhotonASTCopy._superApplyWithArgs(this,'set')}))},
"get":function(){var $elf=this,_fromIdx=this.input.idx,name;return this._or((function(){return (function(){name=this._apply("anything");this._pred((name === "arguments"));return (function (){$elf["context"].declare("$arguments");return ["get","$arguments"]}).call(this)}).call(this)}),(function(){return PhotonASTCopy._superApplyWithArgs(this,'get')}))}});(PhotonDesugar["initialize"]=(function (){(this["context"]=PhotonDesugar["context"].init())}));(PhotonDesugar["context"]=({"init": (function (){var that=Object.create(PhotonDesugar["context"]);(that["scope"]=null);(that["previous_scopes"]=[]);(that["fct_env"]=null);(that["previous_fct_env"]=[]);return that}),"enter_function_scope": (function (){this["previous_scopes"].push(this["scope"]);(this["scope"]=({}));this["previous_fct_env"].push(this["fct_env"]);(this["fct_env"]=[])}),"leave_function_scope": (function (type){var vs=[];for(id in this["scope"]){if((this["scope"][id] === false)){if((type === "global")){vs.push(["set",["get",id],["get","undefined"]])}else{vs.push(["var",id,["get","undefined"]])}}else{undefined}};var fcts=[];for(var i=(0);(i < this["fct_env"]["length"]);++i){var fctStmt=this["fct_env"][i];fcts.push(["set",["get",fctStmt[(0)]],fctStmt[(1)]])};(this["scope"]=this["previous_scopes"].pop());(this["fct_env"]=this["previous_fct_env"].pop());return [["begin"].concat(vs),["begin"].concat(fcts)]}),"declare": (function (id){if((this["scope"][id] === undefined)){(this["scope"][id]=false)}else{undefined}}),"args": (function (ids){for(var i=(0);(i < ids["length"]);++i){(this["scope"][ids[i]]=true)}}),"replace_arguments": (function (args){return args.map((function (x){return ((x === "arguments")?"$arguments":x)}))})}));PhotonVarAnalysis=objectThatDelegatesTo(PhotonASTTraversal,{
"global":function(){var $elf=this,_fromIdx=this.input.idx,ctxt;return (function(){ctxt=this._apply("anything");(function (){(ctxt["scope"]=scope(null));return $elf["_ctxt"].push(ctxt)}).call(this);this._apply("trans");return ctxt["scope"].resolve()}).call(this)},
"get":function(){var $elf=this,_fromIdx=this.input.idx,x;return this._or((function(){return (function(){switch(this._apply('anything')){case "true":return "true";case "false":return "false";case "undefined":return "undefined";case "null":return "null";case "$arguments":return (function (){var a=$elf.scope().lookup("$arguments");if(((a === undefined) || (! a["isParam"]))){$elf.scope().set_use_arguments()}else{undefined}}).call(this);default: throw fail}}).call(this)}),(function(){return (function(){x=this._apply("anything");return $elf.scope().use(x)}).call(this)}))},
"var":function(){var $elf=this,_fromIdx=this.input.idx,name;return (function(){name=this._apply("anything");$elf.scope().declare(name,false);return this._apply("trans")}).call(this)},
"func":function(){var $elf=this,_fromIdx=this.input.idx,args,ctxt;return (function(){args=this._apply("anything");ctxt=this._apply("anything");(function (){(ctxt["scope"]=scope($elf.scope()));$elf["_ctxt"].push(ctxt);return $elf.add_args(args)}).call(this);this._apply("trans");return $elf["_ctxt"].pop()}).call(this)},
"try":function(){var $elf=this,_fromIdx=this.input.idx,ctxt,name;return (function(){ctxt=this._apply("anything");this._apply("trans");name=this._apply("anything");(function (){(ctxt["scope"]=let_scope($elf.scope(),[name]));return $elf["_ctxt"].push(ctxt)}).call(this);this._apply("trans");$elf["_ctxt"].pop();return this._apply("trans")}).call(this)},
"letvar":function(){var $elf=this,_fromIdx=this.input.idx,name;return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","var");name=this._apply("anything");return this._apply("trans")}).call(this)}));return name}).call(this)},
"let":function(){var $elf=this,_fromIdx=this.input.idx,ctxt,ns;return (function(){ctxt=this._apply("anything");this._form((function(){return (function(){this._applyWithArgs("exactly","begin");return ns=this._many((function(){return this._apply("letvar")}))}).call(this)}));(function (){(ctxt["scope"]=let_scope($elf.scope(),ns));return $elf["_ctxt"].push(ctxt)}).call(this);this._apply("trans");return $elf["_ctxt"].pop()}).call(this)}});(PhotonVarAnalysis["initialize"]=(function (){(this["_ctxt"]=[]);(this["scope"]=(function (){return this["_ctxt"][(this["_ctxt"]["length"] - (1))]["scope"]}));(this["print_scope"]=(function (){for(var p=undefined in this.scope()){print(((("var " + p) + " is ") + this.scope()[p]))}}));(this["add_args"]=(function (args){for(var i=(0);(i < args["length"]);++i){this.scope().declare(args[i],true)}}))}));PhotonVarScopeBinding=objectThatDelegatesTo(PhotonASTCopy,{
"isGlobal":function(){var $elf=this,_fromIdx=this.input.idx,x;return (function(){x=this._apply("anything");return this._pred(x.is_global())}).call(this)},
"isLocal":function(){var $elf=this,_fromIdx=this.input.idx,x;return (function(){x=this._apply("anything");return this._pred(x.is_local())}).call(this)},
"isEscaping":function(){var $elf=this,_fromIdx=this.input.idx,x;return (function(){x=this._apply("anything");return this._pred(($elf["context"]["scope"].escaping(x["id"]) === x))}).call(this)},
"isCaptured":function(){var $elf=this,_fromIdx=this.input.idx,x;return (function(){x=this._apply("anything");return this._pred(($elf["context"]["scope"].captured(x["id"]) === x))}).call(this)},
"global":function(){var $elf=this,_fromIdx=this.input.idx,ctxt,r;return (function(){ctxt=this._apply("anything");$elf["context"].enter_function_scope(ctxt["scope"]);r=this._apply("trans");$elf["context"].leave_function_scope(ctxt["scope"]);return ["global",ctxt,r]}).call(this)},
"get":function(){var $elf=this,_fromIdx=this.input.idx,c,id,x;return this._or((function(){return (function(){c=this._or((function(){return (function(){switch(this._apply('anything')){case "true":return "true";case "false":return "false";case "undefined":return "undefined";case "null":return "null";default: throw fail}}).call(this)}),(function(){return (function(){this._pred($elf["context"].is_local_scope());return this._applyWithArgs("exactly","arguments")}).call(this)}));return ["get",c]}).call(this)}),(function(){return (function(){x=(function(){id=this._apply("anything");return (function (){var x=$elf["context"]["scope"].lookup(id);if((x === undefined)){throw (("Undefined variable \'" + id) + "\'")}else{undefined};return x}).call(this)}).call(this);return this._or((function(){return (function(){this._applyWithArgs("isGlobal",x);return ["send","__get__",["ref","root_global"],["string",id]]}).call(this)}),(function(){return (function(){this._apply("empty");return ["get",id]}).call(this)}))}).call(this)}))},
"call":function(){var $elf=this,_fromIdx=this.input.idx,id,x,args;return this._or((function(){return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","get");return id=this._apply("anything")}).call(this)}));x=$elf["context"]["scope"].lookup(id);this._pred(x.is_global());args=this._many((function(){return this._apply("trans")}));return ["send",id,["ref","root_global"]].concat(args)}).call(this)}),(function(){return PhotonASTCopy._superApplyWithArgs(this,'call')}))},
"set":function(){var $elf=this,_fromIdx=this.input.idx,id,x,val;return this._or((function(){return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","get");return id=this._apply("anything")}).call(this)}));x=$elf["context"]["scope"].lookup(id);this._applyWithArgs("isGlobal",x);val=this._apply("trans");return ["send","__set__",["ref","root_global"],["string",id],val]}).call(this)}),(function(){return PhotonASTCopy._superApplyWithArgs(this,'set')}))},
"func":function(){var $elf=this,_fromIdx=this.input.idx,args,ctxt,body;return (function(){args=this._apply("anything");ctxt=this._apply("anything");$elf["context"].enter_function_scope(ctxt["scope"]);body=this._apply("trans");$elf["context"].leave_function_scope();return (function (){var newBody=["begin"].concat([body[(1)]]).concat($elf["context"].gen_arguments(args["length"],ctxt["scope"])).concat(body.slice((2)));return ["func",args,ctxt,newBody]}).call(this)}).call(this)},
"forIn":function(){var $elf=this,_fromIdx=this.input.idx,id,x,arr,body;return this._or((function(){return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","get");return id=this._apply("anything")}).call(this)}));x=$elf["context"]["scope"].lookup(id);this._pred(x.is_global());arr=this._apply("trans");body=this._apply("trans");return (function (){var forInVarName=("forInVar" + PhotonVarScopeBinding["forInVarCount"]++);return ["forIn",["get",forInVarName],arr,["begin",["send","__set__",["ref","root_global"],["string",id],["get",forInVarName]]].concat([body])]}).call(this)}).call(this)}),(function(){return PhotonASTCopy._superApplyWithArgs(this,'forIn')}))},
"try":function(){var $elf=this,_fromIdx=this.input.idx,ctxt,x,name,es,c,f;return (function(){ctxt=this._apply("anything");x=this._apply("trans");name=this._apply("anything");$elf["context"].enter_let_scope(ctxt["scope"]);es=$elf["context"]["scope"]["_escaping"];c=this._apply("trans");$elf["context"].leave_let_scope(ctxt["scope"]);f=this._apply("trans");return ["try",ctxt,x,name,["begin"].concat($elf["context"].gen_escaping(es)).concat(c.slice((1))),f]}).call(this)},
"letvar":function(){var $elf=this,_fromIdx=this.input.idx,s,name,val;return (function(){s=this._apply("anything");this._form((function(){return (function(){this._applyWithArgs("exactly","var");name=this._apply("anything");return val=this._apply("trans")}).call(this)}));return this._or((function(){return (function(){this._pred((s["_escaping"][name] !== undefined));return ["var",name,["send","__new__",["ref","root.cell"],val]]}).call(this)}),(function(){return ["var",name,val]}))}).call(this)},
"let":function(){var $elf=this,_fromIdx=this.input.idx,ctxt,vs,body;return (function(){ctxt=this._apply("anything");this._form((function(){return (function(){this._applyWithArgs("exactly","begin");return vs=this._many((function(){return this._applyWithArgs("letvar",ctxt["scope"])}))}).call(this)}));$elf["context"].enter_let_scope(ctxt["scope"]);body=this._apply("trans");$elf["context"].leave_let_scope(ctxt["scope"]);return ["let",ctxt,["begin"].concat(vs),body]}).call(this)},
"postop":function(){var $elf=this,_fromIdx=this.input.idx,op,id,x;return this._or((function(){return (function(){op=(function(){switch(this._apply('anything')){case "++":return "+";case "--":return "-";default: throw fail}}).call(this);this._form((function(){return (function(){this._applyWithArgs("exactly","get");return id=this._apply("anything")}).call(this)}));x=$elf["context"]["scope"].lookup(id);this._applyWithArgs("isGlobal",x);return (function (){var x=gensym();return ["let",({"scope": local_let_scope($elf["context"]["scope"],[x])}),["begin",["var",x,["send","__get__",["ref","root_global"],["string",id]]]],["begin",["send","__set__",["ref","root_global"],["string",id],["binop",op,["get",x],["number",(1)]]],["get",x]]]}).call(this)}).call(this)}),(function(){return PhotonASTCopy._superApplyWithArgs(this,'postop')}))},
"preop":function(){var $elf=this,_fromIdx=this.input.idx,op,id,x;return this._or((function(){return (function(){op=this._apply("anything");this._form((function(){return (function(){this._applyWithArgs("exactly","get");return id=this._apply("anything")}).call(this)}));x=$elf["context"]["scope"].lookup(id);this._applyWithArgs("isGlobal",x);return (function (){var x=gensym();return ["let",({"scope": local_let_scope($elf["context"]["scope"],[x])}),["begin",["var",x,["send","__get__",["ref","root_global"],["string",id]]]],["begin",["send","__set__",["ref","root_global"],["string",id],["preop",op,["get",x]]]]]}).call(this)}).call(this)}),(function(){return PhotonASTCopy._superApplyWithArgs(this,'preop')}))}});(PhotonVarScopeBinding["forInVarCount"]=(0));(PhotonVarScopeBinding["initialize"]=(function (){(this["context"]=PhotonVarScopeBinding["context"].init())}));(PhotonVarScopeBinding["context"]=({"init": (function (){var that=Object.create(PhotonVarScopeBinding["context"]);(that["scope"]=null);(that["previous_scopes"]=[]);(that["closure_offsets"]=null);(that["previous_closure_offsets"]=[]);(that["closure_offset_begin"]=(0));return that}),"enter_function_scope": (function (scope){this["previous_scopes"].push(this["scope"]);(this["scope"]=scope);this["previous_closure_offsets"].push(this["closure_offsets"]);(this["closure_offsets"]=({}));var i=this["closure_offset_begin"];for(var id=undefined in scope.captured()){(this["closure_offsets"][id]=i++)}}),"leave_function_scope": (function (scope){(this["scope"]=this["previous_scopes"].pop());(this["closure_offsets"]=this["previous_closure_offsets"].pop())}),"enter_let_scope": (function (scope){this["previous_scopes"].push(this["scope"]);(this["scope"]=scope)}),"leave_let_scope": (function (scope){(this["scope"]=this["previous_scopes"].pop())}),"gen_local": (function (ls){return ls.map((function (l){return ["var",l["id"],["get","undefined"]]}))}),"gen_escaping": (function (es){var a=[];for(id in es){var v=es[id];if((v["scope"]["useArguments"] && v["isParam"])){continue}else{undefined};a.push(["set",["get",id],["send","__new__",["ref","root.cell"],["get",id]]])};return a}),"gen_cell_capture": (function (cs,os,f){var a=[];for(id in cs){if((this["scope"].escaping(id) !== undefined)){a.push(["set",["closureRef",["get",f],["number",os[id]]],["get",id]])}else{a.push(["set",["closureRef",["get",f],["number",os[id]]],["closureRef",["closure"],["number",this["closure_offsets"][id]]]])}};return a}),"gen_arguments": (function (expected_nb,scope){if(scope["useArguments"]){return [["set",["get","$arguments"],["wrapExpr","(new ArgumentsProxy(","))",["get","arguments"]]]]}else{return []}}),"is_local_scope": (function (){return (this["previous_scopes"]["length"] !== (1))})}));PhotonLetConv=objectThatDelegatesTo(PhotonASTCopy,{
"trans":function(){var $elf=this,_fromIdx=this.input.idx,t,ans;return (function(){this._form((function(){return (function(){t=this._apply("anything");return ans=this._applyWithArgs("apply",t)}).call(this)}));return ans}).call(this)},
"letvars":function(){var $elf=this,_fromIdx=this.input.idx,name,val,es;return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","begin");return es=this._many((function(){return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","var");name=this._apply("anything");return val=this._apply("trans")}).call(this)}));return [name,val]}).call(this)}))}).call(this)}));return es}).call(this)},
"let":function(){var $elf=this,_fromIdx=this.input.idx,ctxt,es,body;return (function(){ctxt=this._apply("anything");es=this._apply("letvars");body=this._apply("trans");return ["letLambda",$elf.names(es),$elf.values(es),$elf.bodyConv(body)]}).call(this)}});(PhotonLetConv["initialize"]=(function (){(this["names"]=(function (es){return es.map((function (x){return x[(0)]}))}));(this["values"]=(function (es){return es.map((function (x){return x[(1)]}))}));(this["stmts"]=({"if": true,"while": true,"for": true,"forIn": true,"try": true,"switch": true,"with": true}));(this["bodyConv"]=(function (body){var last=body[(body["length"] - (1))];if(this["stmts"][last[(0)]]){return body.concat(["return",["get","undefined"]])}else{(body[(body["length"] - (1))]=["return",last]);return body}}))}));PhotonICConv=objectThatDelegatesTo(PhotonASTCopy,{
"trans":function(){var $elf=this,_fromIdx=this.input.idx,t,ans;return (function(){this._form((function(){return (function(){t=this._apply("anything");return ans=this._applyWithArgs("apply",t)}).call(this)}));return ans}).call(this)},
"send":function(){var $elf=this,_fromIdx=this.input.idx,msg,recv,args;return this._or((function(){return (function(){msg=this._apply("anything");this._pred(((msg === "__$call__") || (msg === "__$apply__")));recv=this._apply("trans");args=this._many((function(){return this._apply("trans")}));return ["send",msg,recv].concat(args)}).call(this)}),(function(){return (function(){msg=this._apply("anything");recv=this._apply("trans");args=this._many((function(){return this._apply("trans")}));return (function (){var nb=PhotonICConv["icCount"]++;var argTypes=[recv[(0)].toProgramString()].concat(args.map((function (x){return x[(0)].toProgramString()})));this["global_scope"].push(["set",["get",("codeCache" + nb)],["code","initState"]],["set",["get",("dataCache" + nb)],["code",(((((("[" + nb) + ",") + msg.toProgramString()) + ",[") + argTypes.join(",")) + "]]")]]);return ["icSend",nb,msg,recv].concat(args)}).call(this)}).call(this)}))},
"call":function(){var $elf=this,_fromIdx=this.input.idx,fn,args;return (function(){fn=this._apply("trans");args=this._many((function(){return this._apply("trans")}));return (function (){var nb=PhotonICConv["icCount"]++;var msg="call";this["global_scope"].push(["set",["get",("codeCache" + nb)],["code","initState"]],["set",["get",("dataCache" + nb)],["code",(((("[" + nb) + ",") + msg.toProgramString()) + ",[]]")]]);return ["icSend",nb,msg,fn,["ref","root_global"]].concat(args)}).call(this)}).call(this)},
"func":function(){var $elf=this,_fromIdx=this.input.idx,args,ctxt,body;return (function(){args=this._apply("anything");ctxt=this._apply("anything");body=this._apply("trans");return (function (){var nb=PhotonICConv["icCount"]++;var msg="__new__";this["global_scope"].push(["set",["get",("codeCache" + nb)],["code","initState"]],["set",["get",("dataCache" + nb)],["code",(((("[" + nb) + ",") + msg.toProgramString()) + ",[]]")]]);return ["icSend",nb,msg,["ref","root.function"],["func",args,ctxt,body]]}).call(this)}).call(this)},
"json":function(){var $elf=this,_fromIdx=this.input.idx,props;return (function(){props=this._many((function(){return this._apply("trans")}));return (function (){var objPayloadName=("objPayload" + PhotonICConv["objPayloadCount"]++);var nb=PhotonICConv["icCount"]++;var propNames=props.map((function (b){return b[(1)]}));var propValues=props.map((function (b){return b[(2)]}));var args=[];var stmts=[];var propNamesStr=[];for(var i=(0);(i < propNames["length"]);++i){args.push(("x" + i));var str=propNames[i][(1)].toProgramString();stmts.push(((("    this[" + str) + "] = x") + i));propNamesStr.push(str)};var fn=(((("function (" + args.join(",")) + ") {\n") + stmts.join(";\n")) + ";\n}");var objCreatePre=("root.object.createWithPayloadAndMap(new " + objPayloadName);var objCreatePost=((", " + objPayloadName) + ".map)");this["global_scope"].push(["set",["get",objPayloadName],["code",fn]],["set",["code",(objPayloadName + ".prototype")],["code","root.object.payload"]],["set",["code",(objPayloadName + ".map")],["code",(("getMap(root.object.newMap, [" + propNamesStr.join(",")) + "])")]],["set",["get",("codeCache" + nb)],["code","initState"]],["set",["get",("dataCache" + nb)],["code",(((("[" + nb) + ", ") + "__new__".toProgramString()) + ",[]]")]]);return ["icSend",nb,"__new__",["ref","root.object"],["wrapExpr",objCreatePre,objCreatePost,["exprSeq"].concat(propValues)]]}).call(this)}).call(this)},
"arr":function(){var $elf=this,_fromIdx=this.input.idx,xs;return (function(){xs=this._many((function(){return this._apply("trans")}));return (function (){var nb=PhotonICConv["icCount"]++;var msg="__new__";this["global_scope"].push(["set",["get",("codeCache" + nb)],["code","initState"]],["set",["get",("dataCache" + nb)],["code",(((("[" + nb) + ",") + msg.toProgramString()) + ",[]]")]]);return ["icSend",nb,msg,["ref","root.array"],["wrapExpr","(new ArrayProxy(","))",["arr"].concat(xs)]]}).call(this)}).call(this)},
"global":function(){var $elf=this,_fromIdx=this.input.idx,ctxt,r;return (function(){ctxt=this._apply("anything");r=this._apply("trans");return ["global",ctxt,["begin",["begin"].concat(this["global_scope"]),r]]}).call(this)}});(PhotonICConv["initialize"]=(function (){(this["global_scope"]=[])}));(PhotonICConv["icCount"]=(0));(PhotonICConv["objPayloadCount"]=(0));PhotonSendConv=objectThatDelegatesTo(PhotonASTCopy,{
"trans":function(){var $elf=this,_fromIdx=this.input.idx,t,ans;return (function(){this._form((function(){return (function(){t=this._apply("anything");return ans=this._applyWithArgs("apply",t)}).call(this)}));return ans}).call(this)},
"call":function(){var $elf=this,_fromIdx=this.input.idx,fn,args;return (function(){fn=this._apply("trans");args=this._many((function(){return this._apply("trans")}));return ["send","call",fn,["ref","root_global"]].concat(args)}).call(this)},
"func":function(){var $elf=this,_fromIdx=this.input.idx,args,ctxt,body;return (function(){args=this._apply("anything");ctxt=this._apply("anything");body=this._apply("trans");return ["send","__new__",["ref","root.function"],["func",args,ctxt,body]]}).call(this)},
"json":function(){var $elf=this,_fromIdx=this.input.idx,props;return (function(){props=this._many((function(){return this._apply("trans")}));return (function (){var objPayloadName=("objPayload" + PhotonSendConv["objPayloadCount"]++);var propNames=props.map((function (b){return b[(1)]}));var propValues=props.map((function (b){return b[(2)]}));var args=[];var stmts=[];var propNamesStr=[];for(var i=(0);(i < propNames["length"]);++i){args.push(("x" + i));var str=propNames[i][(1)].toProgramString();stmts.push(((("    this[" + str) + "] = x") + i));propNamesStr.push(str)};var fn=(((("function (" + args.join(",")) + ") {\n") + stmts.join(";\n")) + ";\n}");var objCreatePre=("root.object.createWithPayloadAndMap(new " + objPayloadName);var objCreatePost=((", " + objPayloadName) + ".map)");this["global_scope"].push(["set",["get",objPayloadName],["code",fn]],["set",["code",(objPayloadName + ".prototype")],["code","root.object.payload"]],["set",["code",(objPayloadName + ".map")],["code",(("getMap(root.object.newMap, [" + propNamesStr.join(",")) + "])")]]);return ["send","__new__",["ref","root.object"],["wrapExpr",objCreatePre,objCreatePost,["exprSeq"].concat(propValues)]]}).call(this)}).call(this)},
"arr":function(){var $elf=this,_fromIdx=this.input.idx,xs;return (function(){xs=this._many((function(){return this._apply("trans")}));return ["send","__new__",["ref","root.array"],["wrapExpr","(new ArrayProxy(","))",["arr"].concat(xs)]]}).call(this)},
"global":function(){var $elf=this,_fromIdx=this.input.idx,ctxt,r;return (function(){ctxt=this._apply("anything");r=this._apply("trans");return ["global",ctxt,["begin",["begin"].concat(this["global_scope"]),r]]}).call(this)}});(PhotonSendConv["initialize"]=(function (){(this["global_scope"]=[])}));(PhotonSendConv["icCount"]=(0));(PhotonSendConv["objPayloadCount"]=(0));PhotonJSCodeGen=objectThatDelegatesTo(OMeta,{
"trans":function(){var $elf=this,_fromIdx=this.input.idx,t,ans;return (function(){this._form((function(){return (function(){t=this._apply("anything");return ans=this._applyWithArgs("apply",t)}).call(this)}));return ans}).call(this)},
"flatten":function(){var $elf=this,_fromIdx=this.input.idx,a,x;return (function(){a=this._apply("anything");return this._or((function(){return this._form((function(){return (function(){this._applyWithArgs("exactly","begin");return this._many((function(){return this._applyWithArgs("flatten",a)}))}).call(this)}))}),(function(){return (function(){x=this._apply("stmt");return a.push((($elf.ilvl() + x) + "\n"))}).call(this)}),(function(){return (function(){x=this._apply("trans");return a.push((($elf.ilvl() + x) + ";\n"))}).call(this)}))}).call(this)},
"flat":function(){var $elf=this,_fromIdx=this.input.idx,stmts;return (function(){stmts=[];this._many((function(){return this._applyWithArgs("flatten",stmts)}));return stmts.join("")}).call(this)},
"stmt":function(){var $elf=this,_fromIdx=this.input.idx,t,ans;return (function(){this._form((function(){return (function(){t=this._apply("anything");this._applyWithArgs("isStmt",t);return ans=this._applyWithArgs("apply",t)}).call(this)}));return ans}).call(this)},
"isStmt":function(){var $elf=this,_fromIdx=this.input.idx,t;return (function(){t=this._apply("anything");return this._pred(($elf["stmts"][t] !== undefined))}).call(this)},
"block":function(){var $elf=this,_fromIdx=this.input.idx,body;return (function(){this._apply("inc");body=this._apply("blockBody");this._apply("dec");return (((($elf.ilvl() + "{\n") + body) + $elf.ilvl()) + "}")}).call(this)},
"blockBody":function(){var $elf=this,_fromIdx=this.input.idx,t,ans,x;return this._or((function(){return (function(){this._form((function(){return (function(){t=this._apply("anything");this._pred((t === "begin"));return ans=this._applyWithArgs("apply","begin")}).call(this)}));return ans}).call(this)}),(function(){return (function(){x=this._apply("stmt");return (($elf.ilvl() + x) + "\n")}).call(this)}),(function(){return (function(){x=this._apply("trans");return (($elf.ilvl() + x) + ";\n")}).call(this)}))},
"exprList":function(){var $elf=this,_fromIdx=this.input.idx,name,val,es;return this._or((function(){return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","begin");return es=this._many((function(){return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","var");name=this._apply("anything");return val=this._apply("trans")}).call(this)}));return ((name + " = ") + val)}).call(this)}))}).call(this)}));return ((es["length"] > (0))?("var " + es.join(", ")):"")}).call(this)}),(function(){return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","begin");return es=this._many((function(){return this._apply("trans")}))}).call(this)}));return es.join(", ")}).call(this)}))},
"inc":function(){var $elf=this,_fromIdx=this.input.idx;return $elf["i"]++},
"dec":function(){var $elf=this,_fromIdx=this.input.idx;return $elf["i"]--},
"global":function(){var $elf=this,_fromIdx=this.input.idx,ctxt,r;return (function(){ctxt=this._apply("anything");r=this._apply("trans");return r}).call(this)},
"var":function(){var $elf=this,_fromIdx=this.input.idx,name,v;return (function(){name=this._apply("anything");v=this._apply("trans");return ((("var " + name) + " = ") + v)}).call(this)},
"this":function(){var $elf=this,_fromIdx=this.input.idx;return (function(){this._apply("end");return "$this"}).call(this)},
"break":function(){var $elf=this,_fromIdx=this.input.idx;return (function(){this._apply("end");return "break"}).call(this)},
"continue":function(){var $elf=this,_fromIdx=this.input.idx;return (function(){this._apply("end");return "continue"}).call(this)},
"number":function(){var $elf=this,_fromIdx=this.input.idx,n;return (function(){n=this._apply("anything");return String(n)}).call(this)},
"regexp":function(){var $elf=this,_fromIdx=this.input.idx,str_e;return (function(){str_e=this._apply("anything");return (("(" + str_e) + ")")}).call(this)},
"string":function(){var $elf=this,_fromIdx=this.input.idx,s;return (function(){s=this._apply("anything");return s.toProgramString()}).call(this)},
"unop":function(){var $elf=this,_fromIdx=this.input.idx,x,op;return this._or((function(){return (function(){switch(this._apply('anything')){case "typeof":return (function(){x=this._apply("trans");return (("(getTypeof(" + x) + "))")}).call(this);default: throw fail}}).call(this)}),(function(){return (function(){op=this._apply("anything");x=this._apply("trans");return (((("(" + op) + " ") + x) + ")")}).call(this)}))},
"preop":function(){var $elf=this,_fromIdx=this.input.idx,op,x;return (function(){op=this._apply("anything");x=this._apply("trans");return ((("(" + op) + x) + ")")}).call(this)},
"postop":function(){var $elf=this,_fromIdx=this.input.idx,op,x;return (function(){op=this._apply("anything");x=this._apply("trans");return ((("(" + x) + op) + ")")}).call(this)},
"get":function(){var $elf=this,_fromIdx=this.input.idx,x;return this._or((function(){return (function(){this._applyWithArgs("token","arguments");return "$arguments"}).call(this)}),(function(){return (function(){x=this._apply("anything");return x}).call(this)}))},
"getCell":function(){var $elf=this,_fromIdx=this.input.idx,x;return (function(){x=this._apply("anything");return (("(" + x) + ".payload)")}).call(this)},
"closure":function(){var $elf=this,_fromIdx=this.input.idx;return "$closure"},
"closureRef":function(){var $elf=this,_fromIdx=this.input.idx,fn,offset;return (function(){fn=this._apply("trans");offset=this._apply("trans");return (((("(" + fn) + ".payload.cells[") + offset) + "])")}).call(this)},
"set":function(){var $elf=this,_fromIdx=this.input.idx,fn,offset,rhs;return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","closureRef");fn=this._apply("trans");return offset=this._apply("trans")}).call(this)}));rhs=this._apply("trans");return (((((("(" + fn) + ".payload.cells[") + offset) + "] = ") + rhs) + ")")}).call(this)},
"closureRefValue":function(){var $elf=this,_fromIdx=this.input.idx,fn,offset;return (function(){fn=this._apply("trans");offset=this._apply("trans");return (((("(" + fn) + ".payload.cells[") + offset) + "].payload)")}).call(this)},
"set":function(){var $elf=this,_fromIdx=this.input.idx,fn,offset,rhs,lhs;return this._or((function(){return (function(){this._form((function(){return (function(){this._applyWithArgs("exactly","closureRefValue");fn=this._apply("trans");return offset=this._apply("trans")}).call(this)}));rhs=this._apply("trans");return (((((("(" + fn) + ".payload.cells[") + offset) + "].payload = ") + rhs) + ")")}).call(this)}),(function(){return (function(){lhs=this._apply("trans");rhs=this._apply("trans");return (((("(" + lhs) + " = ") + rhs) + ")")}).call(this)}))},
"binop":function(){var $elf=this,_fromIdx=this.input.idx,op,x,y;return this._or((function(){return (function(){op=(function(){switch(this._apply('anything')){case "in":return "in";case "instanceof":return "instanceof";default: throw fail}}).call(this);x=this._apply("trans");y=this._apply("trans");return (((((("(" + x) + " ") + op) + " getIterable(") + y) + "))")}).call(this)}),(function(){return (function(){op=this._apply("anything");x=this._apply("trans");y=this._apply("trans");return (((((("(" + x) + " ") + op) + " ") + y) + ")")}).call(this)}))},
"return":function(){var $elf=this,_fromIdx=this.input.idx,x;return (function(){x=this._apply("trans");return ("return " + x)}).call(this)},
"with":function(){var $elf=this,_fromIdx=this.input.idx,x,s;return (function(){x=this._apply("trans");s=this._apply("block");return ((("with (" + x) + ")\n") + s)}).call(this)},
"if":function(){var $elf=this,_fromIdx=this.input.idx,cond,t,e;return (function(){cond=this._apply("trans");t=this._apply("block");e=this._apply("block");return ((((("if (" + cond) + ")\n") + t) + " else\n") + e)}).call(this)},
"condExpr":function(){var $elf=this,_fromIdx=this.input.idx,cond,t,e;return (function(){cond=this._apply("trans");t=this._apply("trans");e=this._apply("trans");return (((((("((" + cond) + ") ? ") + t) + " : ") + e) + ")")}).call(this)},
"while":function(){var $elf=this,_fromIdx=this.input.idx,cond,body;return (function(){cond=this._apply("trans");body=this._apply("block");return ((("while (" + cond) + ")\n") + body)}).call(this)},
"doWhile":function(){var $elf=this,_fromIdx=this.input.idx,body,cond;return (function(){body=this._apply("block");cond=this._apply("trans");return (((("do \n" + body) + "while (") + cond) + ")")}).call(this)},
"for":function(){var $elf=this,_fromIdx=this.input.idx,init,cond,upd,body;return (function(){init=this._apply("exprList");cond=this._apply("trans");upd=this._apply("exprList");body=this._apply("block");return ((((((("for (" + init) + "; ") + cond) + "; ") + upd) + ")\n") + body)}).call(this)},
"forIn":function(){var $elf=this,_fromIdx=this.input.idx,x,arr,body;return (function(){x=this._apply("trans");arr=this._apply("trans");body=this._apply("block");return ((((("for (" + x) + " in getIterable(") + arr) + "))\n") + body)}).call(this)},
"begin":function(){var $elf=this,_fromIdx=this.input.idx,stmts;return (function(){stmts=this._apply("flat");return stmts}).call(this)},
"func":function(){var $elf=this,_fromIdx=this.input.idx,args,ctxt,body;return (function(){args=this._apply("anything");ctxt=this._apply("anything");body=this._apply("block");return (((options["gen_function_ids"] && (ctxt["name"] !== undefined)) && (ctxt["name"] !== "undefined"))?(((((("(FunctionProxyWithId(function (" + ["$this","$closure"].concat(args).join(",")) + ")\n") + body) + ", ") + ctxt["name"].toProgramString()) + "))"):(((("(new FunctionProxy(function (" + ["$this","$closure"].concat(args).join(",")) + ")\n") + body) + "))"))}).call(this)},
"call":function(){var $elf=this,_fromIdx=this.input.idx,fn,args;return (function(){fn=this._apply("trans");args=this._many((function(){return this._apply("trans")}));return (function (){var n=gensym();return ((((((("(function (" + n) + ") {") + "return send(") + [n,"\"call\"","root_global"].concat(args).join(", ")) + ");})(") + fn) + ")")}).call(this)}).call(this)},
"send":function(){var $elf=this,_fromIdx=this.input.idx,recv,args,msg;return this._or((function(){return (function(){switch(this._apply('anything')){case "__$call__":return (function(){recv=this._apply("trans");args=this._many((function(){return this._apply("trans")}));return (function (){var syms=args.map((function (x){return gensym()}));return ((((((("(function (" + ["$closure"].concat(syms).join(", ")) + ") {") + "return $closure.payload.code(") + [syms[(0)],"$closure"].concat(syms.slice((1))).join(", ")) + ");})(") + [recv].concat(args).join(", ")) + ")")}).call(this)}).call(this);case "__$apply__":return (function(){recv=this._apply("trans");args=this._many((function(){return this._apply("trans")}));return (((((("__$apply__(" + recv) + ", ") + args[(0)]) + ", ") + args[(1)]) + ")")}).call(this);default: throw fail}}).call(this)}),(function(){return (function(){msg=this._apply("anything");recv=this._apply("trans");args=this._many((function(){return this._apply("trans")}));return (("send(" + [recv,(("\"" + msg) + "\"")].concat(args).join(", ")) + ")")}).call(this)}))},
"icSend":function(){var $elf=this,_fromIdx=this.input.idx,nb,msg,recv,args;return (function(){nb=this._apply("anything");msg=this._apply("anything");recv=this._apply("trans");args=this._many((function(){return this._apply("trans")}));return (((("(codeCache" + nb) + "(") + [recv,("dataCache" + nb)].concat(args).join(", ")) + "))")}).call(this)},
"throw":function(){var $elf=this,_fromIdx=this.input.idx,x;return (function(){x=this._apply("trans");return ("throw " + x)}).call(this)},
"try":function(){var $elf=this,_fromIdx=this.input.idx,ctxt,x,name,c,f;return this._or((function(){return (function(){ctxt=this._apply("anything");x=this._apply("block");name=this._apply("anything");this._pred((name === undefined));c=this._apply("block");f=this._apply("block");return ((("try\n" + x) + " finally\n") + f)}).call(this)}),(function(){return (function(){ctxt=this._apply("anything");x=this._apply("block");name=this._apply("anything");c=this._apply("block");f=this._apply("block");return ((((((("try\n" + x) + " catch (") + name) + ")\n") + c) + "finally\n") + f)}).call(this)}))},
"switch":function(){var $elf=this,_fromIdx=this.input.idx,x,cases;return (function(){x=this._apply("trans");this._apply("inc");cases=this._many((function(){return this._apply("trans")}));this._apply("dec");return ((((((("switch (" + x) + ")\n") + $elf.ilvl()) + "{\n") + cases.join("\n")) + $elf.ilvl()) + "}")}).call(this)},
"case":function(){var $elf=this,_fromIdx=this.input.idx,x,y;return (function(){x=this._apply("trans");this._apply("inc");y=this._apply("block");this._apply("dec");return (((($elf.ilvl() + "case ") + x) + ":\n") + y)}).call(this)},
"default":function(){var $elf=this,_fromIdx=this.input.idx,y;return (function(){this._apply("inc");y=this._apply("block");this._apply("dec");return (($elf.ilvl() + "default:\n") + y)}).call(this)},
"exprSeq":function(){var $elf=this,_fromIdx=this.input.idx,es;return (function(){es=this._many((function(){return this._apply("trans")}));return (("(" + es.join(", ")) + ")")}).call(this)},
"arr":function(){var $elf=this,_fromIdx=this.input.idx,xs;return (function(){xs=this._many((function(){return this._apply("trans")}));return (("([" + xs.join(",")) + "])")}).call(this)},
"ref":function(){var $elf=this,_fromIdx=this.input.idx,s;return (function(){s=this._apply("anything");return s}).call(this)},
"code":function(){var $elf=this,_fromIdx=this.input.idx,c;return (function(){c=this._apply("anything");return c}).call(this)},
"letLambda":function(){var $elf=this,_fromIdx=this.input.idx,args,values,body;return (function(){args=this._apply("anything");this._form((function(){return values=this._many((function(){return this._apply("trans")}))}));body=this._apply("block");return (((((("(function (" + args.join(",")) + ")\n") + body) + ")(") + values.join(",")) + ")")}).call(this)},
"postcode":function(){var $elf=this,_fromIdx=this.input.idx,x,s;return (function(){x=this._apply("trans");s=this._apply("anything");return ((("(" + x) + s) + ")")}).call(this)},
"precode":function(){var $elf=this,_fromIdx=this.input.idx,s,x;return (function(){s=this._apply("anything");x=this._apply("trans");return ((("(" + s) + x) + ")")}).call(this)},
"arguments_length":function(){var $elf=this,_fromIdx=this.input.idx;return "(arguments.length - 2)"},
"arguments":function(){var $elf=this,_fromIdx=this.input.idx,i;return (function(){i=this._apply("trans");return (("(arguments[" + i) + "+2])")}).call(this)},
"arguments_slice":function(){var $elf=this,_fromIdx=this.input.idx,i;return (function(){i=this._apply("trans");return (("arr(Array.prototype.slice.call(arguments, " + i) + "+2))")}).call(this)},
"igetp":function(){var $elf=this,_fromIdx=this.input.idx,x,fd;return (function(){x=this._apply("trans");fd=this._apply("trans");return (((("(" + x) + "[") + fd) + "])")}).call(this)},
"wrapExpr":function(){var $elf=this,_fromIdx=this.input.idx,pre,post,es;return (function(){pre=this._apply("anything");post=this._apply("anything");es=this._many((function(){return this._apply("trans")}));return (((("" + pre) + es.join("")) + post) + "")}).call(this)}});(PhotonJSCodeGen["initialize"]=(function (){(this["i"]=(0));(this["sp"]=[""]);(this["stmts"]=({"if": true,"while": true,"for": true,"forIn": true,"try": true,"switch": true,"with": true}));(this["ilvl"]=(function (){while((this["i"] >= this["sp"]["length"])){this["sp"].push((this["sp"][(this["sp"]["length"] - (1))] + "    "))};return this["sp"][this["i"]]}))}))}

